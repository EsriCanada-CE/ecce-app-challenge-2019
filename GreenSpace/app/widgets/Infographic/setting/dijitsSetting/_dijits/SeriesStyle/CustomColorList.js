// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/_base/declare ./CustomColorItem dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/on dojo/_base/html dojo/_base/lang".split(" "),function(f,c,g,h,k,l,d,e,m){return f([h,k,l,g],{baseClass:"infographic-custom-color-list",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"costom-color-list-header"\x3e\x3cdiv title\x3d"${nls.category}"\x3e${nls.category}\x3c/div\x3e\x3cdiv title\x3d"${nls.labelAxis}"\x3e${nls.labelAxis}\x3c/div\x3e\x3cdiv title\x3d"${nls.color}"\x3e${nls.color}\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"costom-color-list" data-dojo-attach-point\x3d"colorList"\x3e\x3c/div\x3e\x3cdiv class\x3d"costom-color-list" data-dojo-attach-point\x3d"otherList"\x3e\x3c/div\x3e\x3c/div\x3e',
constructor:function(a){this.inherited(arguments);this._colorItems=[];this._otherItems=[];a.nls&&(this.nls=a.nls);this.others=[{text:this.nls.nullText,label:this.nls.nullText,id:"null",color:"#808080"},{text:this.nls.others,label:this.nls.others,id:"others",color:"#808080"}]},setConfig:function(a){if(a&&a.categories&&Array.isArray(a.categories)){this.clear();var b=a.categories;a=a.others&&a.others.length?a.others:m.clone(this.others);this._setCategories(b);this._setOthers(a)}},updateColorItemsColor:function(){this._colorItems.length&&
this._colorItems.forEach(function(a){a.setColor(this._getRandomColor())}.bind(this))},setCategoryType:function(a){this._categoryTypes=a;this._colorItems.length&&this._colorItems.forEach(function(b){b.setCategoryType(a)}.bind(this))},_getRandomColor:function(){var a;a=0;if(this._lastColor){var b=this._colors.indexOf(this._lastColor);-1<b&&(a=b+1,a>this._colors.length-1&&(a=0))}return this._lastColor=a=this._colors[a]},_setCategories:function(a){a.forEach(function(a){this.addNewColorItem(a)}.bind(this))},
_setOthers:function(a){a&&a.length&&a.forEach(function(a){var b=!1;"others"===a.id&&(b=!0);this._addOtherColorItem(a,b)}.bind(this))},clear:function(){e.empty(this.colorList);e.empty(this.otherList);this._colorItems=[];this._otherItems=[]},_addOtherColorItem:function(a,b){a=new c({nls:this.nls,config:a});a.placeAt(this.otherList);a.startup();a.hideDeleteButton();b&&a.hideLabelPart();this._otherItems.push(a);this._bindEvent(a)},getColorSettedCategories:function(){return this._colorItems.map(function(a){if(a=
a.getConfig())return a.id+""}).filter(function(a){return!!a})},addNewColorItem:function(a,b){a=new c({nls:this.nls,config:a,categoryTypes:this._categoryTypes});a.placeAt(this.colorList);a.startup();b&&a.highLight();this._colorItems.push(a);this._bindEvent(a);b=this.getColorSettedCategories();this.emit("color-list-change",b);setTimeout(function(){this._onChange()}.bind(this),50)},_bindEvent:function(a){this.own(d(a,"change",function(){this._onChange()}.bind(this)));this.own(d(a,"delete",function(a){this._colorItems=
this._colorItems.filter(function(b){return b.uniqueID!==a}.bind(this));this._onChange();var b=this.getColorSettedCategories();this.emit("color-list-change",b)}.bind(this)))},getConfig:function(){if(!this._colorItems.length&&!this._otherItems.length)return!1;var a=this._colorItems.map(function(a){return a.getConfig()}),a=a.filter(function(a){return!!a}),b=this._otherItems.map(function(a){return a.getConfig()}),b=b.filter(function(a){return!!a});return{categories:a,others:b}},_onChange:function(){var a=
this.getConfig();a&&this.emit("change",a)}})});