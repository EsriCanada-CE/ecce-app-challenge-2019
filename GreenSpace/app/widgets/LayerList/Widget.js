// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/LayerList/LayerListView":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/on dojo/query jimu/dijit/CheckBox jimu/dijit/DropMenu jimu/dijit/LoadingShelter ./PopupMenu dijit/_TemplatedMixin dojo/text!./LayerListView.html dojo/dom-class dojo/dom-style ./NlsStrings".split(" "),function(p,n,f,h,k,d,e,q,m,c,a,l,v,w,t,x){return n([p,l],{templateString:v,_currentSelectedLayerRowNode:null,operationsDropMenu:null,_layerNodeHandles:null,
_layerDomNodeStorage:null,postMixInProperties:function(){this.inherited(arguments);this.nls=x.value;this._layerDomNodeStorage={}},postCreate:function(){this.refresh();this._initOperations()},refresh:function(){this._removeLayerNodes();h.forEach(this.operLayerInfos.getLayerInfoArray(),function(b){this.drawListNode(b,0,this.layerListTable)},this);this.config.showBasemap&&h.forEach(this.operLayerInfos.getBasemapLayerInfoArray(),function(b){this.drawListNode(b,0,this.layerListTable)},this);h.forEach(this.operLayerInfos.getTableInfoArray(),
function(b){this.drawListNode(b,0,this.tableListTable)},this)},drawListNode:function(b,u,g,r){var a;!this.isLayerHiddenInWidget(b)&&this.layerFilter.isValidLayerInfo(b)&&(a=this._layerDomNodeStorage[b.getObjectId()],(b.isRootLayer()||b.isTable)&&a?(k.place(a.layerTrNode,g,r),k.place(a.layerContentTrNode,g,r)):0===b.newSubLayers.length?(a=this.addLayerNode(b,u,g,r),this.config.showLegend?this.addLegendNode(b,u,a.subNode):(b=e(".showLegend-div",a.layerTrNode)[0])&&w.add(b,"hidden")):(a=this.addLayerNode(b,
u,g,r),h.forEach(b.newSubLayers,f.hitch(this,function(b,g){this.drawListNode(g,b+1,a.subNode)},u))))},addLayerNode:function(b,a,g,r){var u,c,m,l,C,e,h=b.getRootLayerInfo();if(b.isRootLayer()||b.isTable)this._layerDomNodeStorage[b.getObjectId()]={layerTrNode:null,layerContentTrNode:null,layerNodeEventHandles:[],layerNodeReferredDijits:[]};u=k.create("tr",{"class":"jimu-widget-row layer-row  layer-tr-node-"+b.id,layerTrNodeId:b.id});k.place(u,g,r);c=k.create("td",{"class":"col col1"},u);for(l=0;l<a;l++)k.create("div",
{"class":"begin-blank-div jimu-float-leading",innerHTML:""},c);e=k.create("div",{"class":"showLegend-div jimu-float-leading",imageShowLegendDivId:b.id},c);m=k.create("div",{"class":"div-select jimu-float-leading"},c);l=new q({checked:b.isVisible(),"class":"visible-checkbox-"+b.id});k.place(l.domNode,m);C=k.create("div",{"class":"noLegend-div jimu-float-leading"},c);var x;x=b.isTable?"images/table.png":b.isBasemap()?"images/basemap.png":"images/noLegend.png";k.create("img",{"class":"noLegend-image",
src:this.layerListWidget.folderUrl+x,alt:"l"},C);if(b.isTiled||b.isTable||b.isBasemap())t.set(e,"display","none"),t.set(m,"display","none"),t.set(C,"display","block");t.set(c,"width",12*a+40+"px");a=k.create("td",{"class":"col col2"},u);c="";try{b.isInScale()||(c="grayed-title")}catch(D){console.warn(D.message)}k.create("div",{innerHTML:b.title,"class":"layer-title-div-"+b.id+" div-content jimu-float-leading "+c},a);c=k.create("td",{"class":"col col3"},u);m=this.hasContentMenu()?"display: block":
"display: none";c=k.create("div",{"class":"layers-list-popupMenu-div",style:m},c);m=k.create("tr",{"class":"",layerContentTrNodeId:b.id});k.place(m,g,r);g=k.create("td",{"class":"",colspan:"3"},m);g=k.create("table",{"class":"layer-sub-node",subNodeId:b.id},g);r=this.own(d(a,"click",f.hitch(this,this._onRowTrClick,b,e,u,g)));this._storeLayerNodeEventHandle(h,r[0]);r=this.own(d(e,"click",f.hitch(this,this._onRowTrClick,b,e,u,g)));this._storeLayerNodeEventHandle(h,r[0]);r=this.own(d(l.domNode,"click",
f.hitch(this,this._onCkSelectNodeClick,b,l)));this._storeLayerNodeEventHandle(h,r[0]);r=this.own(d(c,"click",f.hitch(this,this._onPopupMenuClick,b,c,u)));this._storeLayerNodeEventHandle(h,r[0]);if(b.isRootLayer()||b.isTable)this._layerDomNodeStorage[b.getObjectId()].layerTrNode=u,this._layerDomNodeStorage[b.getObjectId()].layerContentTrNode=m;this.layerFilter.isExpanded(b)&&this._foldOrUnfoldLayer(b,!1,e,g);return{layerTrNode:u,subNode:g}},hasContentMenu:function(){var b=!1,a;if(this.config.contextMenu)for(a in this.config.contextMenu)this.config.contextMenu.hasOwnProperty(a)&&
"function"!==typeof this.config.contextMenu[a]&&(b=b||this.config.contextMenu[a]);else b=!0;return b},addLegendNode:function(b,a,g){g=k.create("tr",{"class":"legend-node-tr"},g);g=k.create("td",{"class":"legend-node-td"},g);try{var r=b.createLegendsNode();t.set(r,"font-size",12*(a+1)+"px");k.place(r,g)}catch(z){console.error(z)}},redrawLegends:function(b){var a=e("div[legendsDivId\x3d'"+b.id+"']",this.layerListTable)[0];a&&(a._legendDijit&&a._legendDijit.destroy&&a._legendDijit.destroy(),b.drawLegends(a,
this.layerListWidget.appConfig.portalUrl))},_storeLayerNodeEventHandle:function(b,a){(b=this._layerDomNodeStorage[b.getObjectId()])&&b.layerNodeEventHandles.push(a)},_storeLayerNodeDijit:function(b,a){(b=this._layerDomNodeStorage[b.getObjectId()])&&b.layerNodeReferredDijits.push(a)},_clearLayerDomNodeStorage:function(){var b=this.operLayerInfos.getLayerInfoArray(),a=this.operLayerInfos.getTableInfoArray(),b=b.concat(a),g;for(g in this._layerDomNodeStorage)this._layerDomNodeStorage.hasOwnProperty(g)&&
"function"!==typeof this._layerDomNodeStorage[g]&&(a=h.some(b,function(b){if(b.getObjectId().toString()===g)return!0},this),a||(h.forEach(this._layerDomNodeStorage[g].layerNodeEventHandles,function(b){b.remove()},this),h.forEach(this._layerDomNodeStorage[g].layerNodeReferredDijits,function(b){b.destroy()},this),k.destroy(this._layerDomNodeStorage[g].layerTrNode),k.destroy(this._layerDomNodeStorage[g].layerContentTrNode),delete this._layerDomNodeStorage[g]))},_removeLayerNodes:function(){var b,a;this._clearLayerDomNodeStorage();
for(var g in this._layerDomNodeStorage)this._layerDomNodeStorage.hasOwnProperty(g)&&"function"!==typeof this._layerDomNodeStorage[g]&&(b=this._layerDomNodeStorage[g],b.layerContentTrNode&&b.layerTrNode&&((a=b.layerTrNode.parentNode)&&a.removeChild(b.layerTrNode),(a=b.layerContentTrNode.parentNode)&&a.removeChild(b.layerContentTrNode)))},_foldSwitch:function(b,a,g){return"none"===t.get(g,"display")?this._foldOrUnfoldLayer(b,!1,a,g):this._foldOrUnfoldLayer(b,!0,a,g)},_foldOrUnfoldLayer:function(b,a,
g,r){var c=c?g:e("div[imageShowLegendDivId\x3d'"+b.id+"']",this.layerListTable)[0],d=d?r:e("table[subNodeId\x3d'"+b.id+"']",this.layerListTable)[0];g=null;c&&d&&(a?(t.set(d,"display","none"),w.remove(c,"unfold"),g=!0):(t.set(d,"display","table"),w.add(c,"unfold"),g=!1,b.isLeaf()&&(a=e(".legends-div",d)[0],c=e(".legends-loading-img",a)[0],a&&c&&b.drawLegends(a,this.layerListWidget.appConfig.portalUrl))));return g},_foldOrUnfoldLayers:function(b,a){h.forEach(b,function(b){this._foldOrUnfoldLayer(b,
a)},this)},_onCkSelectNodeClick:function(b,a,g){g.ctrlKey||g.metaKey?b.isRootLayer()?this.turnAllRootLayers(a.checked):this.turnAllSameLevelLayers(b,a.checked):(this.layerListWidget._denyLayerInfosIsVisibleChangedResponseOneTime=!0,b.setTopLayerVisible(a.checked));g.stopPropagation()},_onPopupMenuClick:function(b,c,g,r){var m=b.getRootLayerInfo(),l=c.popupMenu;l||(l=(new a({_layerInfo:b,box:this.layerListWidget.domNode.parentNode,popupMenuNode:c,layerListWidget:this.layerListWidget,_config:this.config})).placeAt(c),
c.popupMenu=l,this._storeLayerNodeDijit(m,l),b=this.own(d(l,"onMenuClick",f.hitch(this,this._onPopupMenuItemClick,b,l))),this._storeLayerNodeEventHandle(m,b[0]));this._changeSelectedLayerRow(g);l&&"opened"===l.state?l.closeDropMenu():(this._hideCurrentPopupMenu(),l&&(this.currentPopupMenu=l,l.openDropMenu()));this.operationsDropMenu&&"opened"===this.operationsDropMenu.state&&this.operationsDropMenu.closeDropMenu();r.stopPropagation()},_hideCurrentPopupMenu:function(){this.currentPopupMenu&&"opened"===
this.currentPopupMenu.state&&this.currentPopupMenu.closeDropMenu()},_onLayerListWidgetPaneClick:function(){this.operationsDropMenu&&this.operationsDropMenu.closeDropMenu()},_onRowTrClick:function(b,a,g,r,c){this._changeSelectedLayerRow(g);a=this._foldSwitch(b,a,r);if(c.ctrlKey||c.metaKey)b.isRootLayer()?this.foldOrUnfoldAllRootLayers(a):this.foldOrUnfoldSameLevelLayers(b,a)},_changeSelectedLayerRow:function(b){this._currentSelectedLayerRowNode&&this._currentSelectedLayerRowNode===b||(this._currentSelectedLayerRowNode&&
w.remove(this._currentSelectedLayerRowNode,"jimu-widget-row-selected"),w.add(b,"jimu-widget-row-selected"),this._currentSelectedLayerRowNode=b)},_onPopupMenuItemClick:function(b,a,g,c){c={itemKey:g.key,extraData:c,layerListWidget:this.layerListWidget,layerListView:this};"transparency"===g.key?"none"===t.get(a.transparencyDiv,"display")?a.showTransNode(b.getOpacity()):a.hideTransNode():"setVisibilityRange"===g.key?"none"===t.get(a.setVisibilityRangeNode,"display")?a.showSetVisibilityRangeNode(b):a.hideSetVisibilityRangeNode():
(b=a.popupMenuInfo.onPopupMenuClick(c),b.closeMenu&&a.closeDropMenu())},_exchangeLayerTrNode:function(b,a){b=e("tr[layerTrNodeId\x3d'"+b.id+"']",this.layerListTable)[0];var g=e("tr[layerTrNodeId\x3d'"+a.id+"']",this.layerListTable)[0];a=e("tr[layerContentTrNodeId\x3d'"+a.id+"']",this.layerListTable)[0];b&&g&&a&&(this.layerListTable.removeChild(g),this.layerListTable.insertBefore(g,b),this.layerListTable.removeChild(a),this.layerListTable.insertBefore(a,b))},_getMovedSteps:function(b,a){var g=1,c,
d=this.operLayerInfos.getLayerInfoArray();h.forEach(d,function(a,g){b.id===a.id&&(c=g)},this);if("moveup"===a)for(;!d[c].isFirst&&!(c--,!this.isLayerHiddenInWidget(d[c])&&this.layerFilter.isValidLayerInfo(d[c])||d[c].isFirst);)g++;else for(;!d[c].isLast&&!(c++,!this.isLayerHiddenInWidget(d[c])&&this.layerFilter.isValidLayerInfo(d[c])||d[c].isLast);)g++;return g},moveUpLayer:function(b){var a=this._getMovedSteps(b,"moveup");this.layerListWidget._denyLayerInfosReorderResponseOneTime=!0;(a=this.operLayerInfos.moveUpLayer(b,
a))&&this._exchangeLayerTrNode(a,b)},moveDownLayer:function(a){var b=this._getMovedSteps(a,"movedown");this.layerListWidget._denyLayerInfosReorderResponseOneTime=!0;(b=this.operLayerInfos.moveDownLayer(a,b))&&this._exchangeLayerTrNode(a,b)},isLayerHiddenInWidget:function(a){var b=!1,g=a;if(a&&this.config.layerOptions&&void 0!==this.config.layerOptions[a.id])for(;g&&!(b=b||!this.config.layerOptions[g.id].display);)g=g.parentLayerInfo;else b=!1;return b},isFirstDisplayedLayerInfo:function(a){var b,
g;a.isFirst||!a.isRootLayer()||a.isBasemap()?b=!0:(b=this._getMovedSteps(a,"moveup"),g=this.operLayerInfos.getLayerInfoArray(),a=this.operLayerInfos._getTopLayerInfoIndexById(a.id),b=this.isLayerHiddenInWidget(g[a-b])||!this.layerFilter.isValidLayerInfo(g[a-b])?!0:!1);return b},isLastDisplayedLayerInfo:function(a){var b,g;a.isLast||!a.isRootLayer()||a.isBasemap()?b=!0:(b=this._getMovedSteps(a,"movedown"),g=this.operLayerInfos.getLayerInfoArray(),a=this.operLayerInfos._getTopLayerInfoIndexById(a.id),
b=this.isLayerHiddenInWidget(g[a+b])||!this.layerFilter.isValidLayerInfo(g[a+b])?!0:!1);return b},_initOperations:function(){this.operationsDropMenu=(new m({items:[{key:"turnAllLayersOn",label:this.nls.turnAllLayersOn},{key:"turnAllLayersOff",label:this.nls.turnAllLayersOff},{key:"separator"},{key:"expandAllLayers",label:this.nls.expandAllLayers},{key:"collapseAlllayers",label:this.nls.collapseAlllayers}],box:this.layerListWidget.domNode.parentNode})).placeAt(this.layerListOperations);var a=e("div.jimu-dropmenu \x3e div:first-child",
this.layerListOperations)[0];a&&(w.remove(a,["jimu-icon-btn","popup-menu-button"]),w.add(a,["feature-action","icon-operation"]));this.operationsDropMenu.btnNode&&this.own(d(this.operationsDropMenu.btnNode,"click",f.hitch(this,this._onLayerListOperationsClick)));this.own(d(this.operationsDropMenu,"onMenuClick",f.hitch(this,this._onOperationsMenuItemClick)));this.operationsDropMenuLoading=(new c({hidden:!0})).placeAt(this.operationsDropMenu.domNode)},_onLayerListOperationsClick:function(){this._hideCurrentPopupMenu()},
_onOperationsMenuItemClick:function(a){switch(a.key){case "turnAllLayersOn":this.turnAllRootLayers(!0);break;case "turnAllLayersOff":this.turnAllRootLayers(!1);break;case "expandAllLayers":this.foldOrUnfoldAllLayers(!1);break;case "collapseAlllayers":this.foldOrUnfoldAllLayers(!0)}},turnAllRootLayers:function(a){var b=this.operLayerInfos.getLayerInfoArray();h.forEach(b,function(b){this.isLayerHiddenInWidget(b)||b.setTopLayerVisible(a)},this)},turnAllSameLevelLayers:function(a,c){var b={},d=a.getRootLayerInfo();
d.traversal(f.hitch(this,function(g){g.parentLayerInfo&&g.parentLayerInfo.id===a.parentLayerInfo.id&&!this.isLayerHiddenInWidget(g)?b[g.id]={visible:c}:b[g.id]={visible:g.isVisible()}}));d.resetLayerObjectVisibility(b)},foldOrUnfoldAllRootLayers:function(a){var b=h.filter(this.operLayerInfos.getLayerInfoArray(),function(a){return!this.isLayerHiddenInWidget(a)},this);this._foldOrUnfoldLayers(b,a)},foldOrUnfoldSameLevelLayers:function(a,c){a.parentLayerInfo&&(a=h.filter(a.parentLayerInfo.getSubLayers(),
function(a){return!this.isLayerHiddenInWidget(a)},this),this._foldOrUnfoldLayers(a,c))},foldOrUnfoldAllLayers:function(a){var b=[],g=[];this.operationsDropMenuLoading.show();this.operLayerInfos.traversal(f.hitch(this,function(a){this.isLayerHiddenInWidget(a)||(a.isRootLayer()?g.push(a):b.push(a))}));var b=g.concat(b),c=0,d=b.length;setTimeout(f.hitch(this,function(){if(c<d){var g=b.slice(c,c+50);this._foldOrUnfoldLayers(g,a);c+=50;setTimeout(f.hitch(this,arguments.callee),60)}else this.operationsDropMenuLoading.hide()}),
60)}})})},"jimu/dijit/DropMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented ../utils".split(" "),function(p,n,f,h,k,d,e,q){return p([n,e],{baseClass:"jimu-dropmenu",declaredClass:"jimu.dijit.DropMenu",constructor:function(){this.state="closed"},postCreate:function(){this.btnNode=k.create("div",{"class":"popup-menu-button"},this.domNode);this.own(d(this.btnNode,"click",f.hitch(this,this._onBtnClick)));this.box||(this.box=
this.domNode.parentNode);this.own(d(this.box,"click",f.hitch(this,function(){this.dropMenuNode&&this.closeDropMenu()})))},_onBtnClick:function(d){d.stopPropagation();this.dropMenuNode||this._createDropMenuNode();"closed"===this.state?this.openDropMenu():this.closeDropMenu()},_createDropMenuNode:function(){this.dropMenuNode=k.create("div",{"class":"drop-menu",style:{display:"none"}},this.domNode);this.items||(this.items=[]);h.forEach(this.items,function(m){var c;m.key&&"separator"===m.key?k.create("hr",
{"class":"menu-item-identification menu-item-line",itemId:m.key},this.dropMenuNode):m.key&&(c=k.create("div",{"class":"menu-item-identification menu-item",itemId:m.key,innerHTML:m.label},this.dropMenuNode),this.own(d(c,"click",f.hitch(this,function(a){this.selectItem(m,a)}))))},this)},_getDropMenuPosition:function(){var d=k.getContentBox(this.box),c=k.getMarginBox(this.domNode),a=k.getMarginBox(this.btnNode),l=k.getMarginBox(this.dropMenuNode),e={},f,h;e.l=c.l;e.t=c.t+a.h;e.t+l.h>d.h&&(h=c.t,f=d.h-
c.t-a.h,f=Math.max(h,f),f===h&&(e.t=0-l.h));e.l+l.w>d.w&&(l=c.l,d=d.w-c.l-a.w,f=Math.max(l,d),f===l&&(e.l="",e.r=0));e.left=e.l;e.top=e.t;e.right=e.r;return e},selectItem:function(d){this.closeDropMenu();this.emit("onMenuClick",d)},openDropMenu:function(){this.state="opened";k.setStyle(this.dropMenuNode,"display","");k.setStyle(this.dropMenuNode,q.getPositionStyle(this._getDropMenuPosition()));this.emit("onOpenMenu")},closeDropMenu:function(){this.state="closed";k.setStyle(this.dropMenuNode,"display",
"none");this.emit("onCloseMenu")}})})},"widgets/LayerList/PopupMenu":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/_base/lang dojo/query dojo/Deferred jimu/dijit/DropMenu dijit/_TemplatedMixin dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dojo/text!./PopupMenu.html dojo/dom-style esri/dijit/VisibleScaleRangeSlider ./NlsStrings ./PopupMenuInfo".split(" "),function(p,n,f,h,k,d,e,q,m,c,a,l,v,w,t){return p([e,q],{templateString:a,popupMenuInfo:null,loading:null,
_deniedItems:null,_deniedItemsFromConfig:null,_layerInfo:null,constructor:function(){this.nls=w.value},postCreate:function(){this.inherited(arguments);this._initDeniedItems();this.loading=f.create("div",{"class":"popup-menu-loading"},this.popupMenuNode)},_initDeniedItems:function(){var a=[],b={ZoomTo:"zoomto",Transparency:"transparency",SetVisibilityRange:"setVisibilityRange",EnableOrDisablePopup:"controlPopup",ControlLabels:"controlLabels",MoveupOrMovedown:"moveup movedown",OpenAttributeTable:"table",
DescriptionOrShowItemDetailsOrDownload:"url"};this._deniedItems=[];this._deniedItemsFromConfig=[];for(var c in this._config.contextMenu)this._config.contextMenu.hasOwnProperty(c)&&"function"!==typeof this._config.contextMenu[c]&&!1===this._config.contextMenu[c]&&(a=a.concat(b[c].split(" ")));n.forEach(a,h.hitch(this,function(a){this._deniedItemsFromConfig.push({key:a,denyType:"hidden"})}))},_getDropMenuPosition:function(){return{top:"40px",right:"0px",zIndex:1}},_getTransNodePosition:function(){return{top:"28px",
right:"2px"}},_onBtnClick:function(){},_refresh:function(){this._denyItems();this._changeItemsUI()},_denyItems:function(){var a=k("[class~\x3d'menu-item-identification']",this.dropMenuNode);a.forEach(function(a){f.removeClass(a,"menu-item-dissable");f.removeClass(a,"menu-item-hidden")},this);f.removeClass(this.dropMenuNode,"no-border");n.forEach(this._deniedItems,function(a){var b=k("div[itemId\x3d'"+a.key+"']",this.dropMenuNode)[0];b&&("disable"===a.denyType?(f.addClass(b,"menu-item-dissable"),"url"===
a.key&&k(".menu-item-description",b).forEach(function(a){f.setAttr(a,"href","#");f.removeAttr(a,"target")})):f.addClass(b,"menu-item-hidden"))},this);for(var b=-1,c=0;c<a.length;c++)f.hasClass(a[c],"menu-item-line")&&(-1===b||f.hasClass(a[b],"menu-item-line"))&&f.addClass(a[c],"menu-item-hidden"),f.hasClass(a[c],"menu-item-hidden")||(b=c);a=n.filter(a,function(a){return!f.hasClass(a,"menu-item-hidden")});0===a.length?f.addClass(this.dropMenuNode,"no-border"):(f.removeClass(this.dropMenuNode,"no-border"),
f.hasClass(a[a.length-1],"menu-item-line")&&f.addClass(a[a.length-1],"menu-item-hidden"))},_changeItemsUI:function(){var a=k("[itemid\x3dcontrolPopup]",this.dropMenuNode)[0];a&&this._layerInfo.controlPopupInfo&&(this._layerInfo.controlPopupInfo.enablePopup?f.setAttr(a,"innerHTML",this.nls.removePopup):f.setAttr(a,"innerHTML",this.nls.enablePopup));(a=k("[itemid\x3dcontrolLabels]",this.dropMenuNode)[0])&&this._layerInfo.canShowLabel()&&(this._layerInfo.isShowLabels()?f.setAttr(a,"innerHTML",this.nls.hideLables):
f.setAttr(a,"innerHTML",this.nls.showLabels))},_switchLoadingState:function(a){a?f.setStyle(this.loading,"display","block"):f.setStyle(this.loading,"display","none")},selectItem:function(a,b){for(var c=!1,g=0;g<this._deniedItems.length;g++)if(this._deniedItems[g].key===a.key){c=!0;break}c||this.emit("onMenuClick",a);b.stopPropagation(b)},openDropMenu:function(){var a=h.hitch(this,this.inherited,arguments),b=new d;this._switchLoadingState(!0);this.dropMenuNode?b.resolve(this.popupMenuInfo):t.create(this._layerInfo,
this.layerListWidget).then(h.hitch(this,function(a){this.items=a.getDisplayItems();this.popupMenuInfo=a;this._createDropMenuNode();b.resolve(this.popupMenuInfo)}));b.then(h.hitch(this,function(){this.popupMenuInfo.getDeniedItems().then(h.hitch(this,function(b){this._deniedItems=this._deniedItemsFromConfig.concat(b);this._refresh();a(arguments);this._switchLoadingState(!1)}),h.hitch(this,function(){this._switchLoadingState(!1)}))}),h.hitch(this,function(){this._switchLoadingState(!1)}))},closeDropMenu:function(){this.inherited(arguments);
this.hideTransNode();this.hideSetVisibilityRangeNode()},_onTransparencyDivClick:function(a){a.stopPropagation()},showTransNode:function(a){this.hideSetVisibilityRangeNode();this.transHorizSlider||(this._createTransparencyWidget(),this.transHorizSlider.set("value",1-a));l.set(this.transparencyDiv,"top",this._getTransNodePosition().top);isRTL?l.set(this.transparencyDiv,"left",this._getTransNodePosition().right):l.set(this.transparencyDiv,"right",this._getTransNodePosition().right);l.set(this.transparencyDiv,
"display","block")},hideTransNode:function(){l.set(this.transparencyDiv,"display","none")},_createTransparencyWidget:function(){this.transHorizSlider=new m({minimum:0,maximum:1,intermediateChanges:!0},this.transparencyBody);this.own(this.transHorizSlider.on("change",h.hitch(this,function(a){this.emit("onMenuClick",{key:"transparencyChanged"},{newTransValue:a})})));new c({container:"bottomDecoration"},this.transparencyRule)},_onSetVisibilityRangeNode:function(a){a.stopPropagation()},showSetVisibilityRangeNode:function(a){this.hideTransNode();
if(!this.visibleScaleRangeSlider){var b=a.getScaleRange();this.visibleScaleRangeSlider=(new v({map:a.map,minScale:b.minScale,maxScale:b.maxScale})).placeAt(this.setVisibilityRangeNode);this.visibleScaleRangeSlider.startup()}this.own(this.visibleScaleRangeSlider.on("scale-range-change",h.hitch(this,function(b){a.setScaleRange(b.minScale,b.maxScale)})));l.set(this.setVisibilityRangeNode,"top",this._getTransNodePosition().top);isRTL?l.set(this.setVisibilityRangeNode,"left",this._getTransNodePosition().right):
l.set(this.setVisibilityRangeNode,"right",this._getTransNodePosition().right);l.set(this.setVisibilityRangeNode,"display","block")},hideSetVisibilityRangeNode:function(){l.set(this.setVisibilityRangeNode,"display","none")},hide:function(){l.set(this.domNode,"display","none")},show:function(){l.set(this.domNode,"display","block")}})})},"esri/dijit/VisibleScaleRangeSlider":function(){define("../kernel ./_EventedWidget ./_Tooltip ./VisibleScaleRangeSlider/_RecommendedScaleRangeBounds ./VisibleScaleRangeSlider/_SlideEvent ./VisibleScaleRangeSlider/ScaleMenu ./VisibleScaleRangeSlider/ScalePreview ./VisibleScaleRangeSlider/ScaleRanges dijit/form/DropDownButton dijit/popup dojo/_base/array dojo/_base/lang dojo/aspect dojo/debounce dojo/Deferred dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/on dojo/string dojox/form/HorizontalRangeSlider dojo/i18n!../nls/jsapi".split(" "),
function(p,n,f,h,k,d,e,q,m,c,a,l,v,w,t,x,b,u,g,r,z,y,A,B){n=n.createSubclass([f],{declaredClass:"esri.dijit.VisibleScaleRangeSlider",baseClass:"esriVisibleScaleRangeSlider",css:{currentScaleIndicator:"esriCurrentScaleIndicator",currentScaleIndicatorContainer:"esriCurrentScaleIndicatorContainer",scaleIndicator:"esriScaleIndicator",scaleIndicatorContainer:"esriScaleIndicatorContainer"},disabled:!1,map:null,layer:null,region:"en-US",minScale:0,maxScale:0,intermediateChanges:!1,labels:B.widgets.visibleScaleRangeSlider,
_slider:null,_currentScaleIndicator:null,_scalePreview:null,_maxScaleButton:null,_minScaleButton:null,_mapUpdateHandler:null,_scaleRanges:null,_scheduleScaleRangeChangeEmit:null,_getSliderIndexRange:function(a){a=Math.floor(a);return{min:a,max:a+.99999}},_setDisabledAttr:function(a){this._slider.set("disabled",a);this._maxScaleButton.set("disabled",a);this._minScaleButton.set("disabled",a);this._set("disabled",a)},_setMapAttr:function(a){this._set("map",a);this._mapUpdateHandler&&this._mapUpdateHandler.remove();
this._slider.set("disabled",!0);this._ensureMap().then(this._updateFromMap)},_setConstraintsAttr:function(a){this._set("constraints",a);this._setUpSlider({minScale:a.minScale,maxScale:a.maxScale})},_updateFromMap:function(a){var b=a.getMinScale(),c=a.getMaxScale();this._setUpSlider({minScale:b,maxScale:c});this._updateCurrentScaleIndicator();a=a.on("zoom-end",l.hitch(this,this._updateCurrentScaleIndicator));this.own(a);this._mapUpdateHandler=a},_setUpSlider:function(a){var b=a.maxScale;a=a.minScale;
var c;this._slider.set("disabled",this.get("disabled"));this._scaleRanges.set("scaleRangeBounds",{minScale:a,maxScale:b});c=this._getSliderIndexRange(this._scaleRanges.length-1);this._slider.set("maximum",c.max);this._silentSliderUpdate({maxScale:b,minScale:a})},_ensureMap:function(){return this._untilLoaded(this.map)},_untilLoaded:function(a){var b=new t;if(a)if(a.loaded)b.resolve(a);else a.on("load",function(){b.resolve(a)});else b.reject(Error("could not load resource"));return b.promise},_updateCurrentScaleIndicator:function(){var a=
this._scaleRanges.clampScale(this.map.getScale()),a=this._mapScaleToSlider(a)/this._slider.maximum;this.isLeftToRight()||(a=1-a);g.set(this._currentScaleIndicator,{left:100*a+"%"})},_setLayerAttr:function(a){this._set("layer",a);this._ensureScaleRangeProvider().then(this._ensureLayer).then(this._updateMinMaxScaleFromLayer)},_ensureLayer:function(){return this._untilLoaded(this.layer)},_updateMinMaxScaleFromLayer:function(a){this.set({minScale:a.minScale,maxScale:a.maxScale})},_mapSliderToScale:function(a){var b=
this._getSliderIndexRange(a),c=this._scaleRanges.findScaleRangeByIndex(a);return this._mapToRange(a,b.min,b.max,c.minScale,c.maxScale)},_mapToRange:function(a,b,c,g,d){return g+(a-b)*(d-g)/(c-b)},_setRegionAttr:function(a){this._set("region",a);this._scalePreview.set("source",q.getScalePreviewSource(a))},_getMinimumAttr:function(){return this._mapSliderToScale(this._slider.minimum)},_getMaximumAttr:function(){return this._mapSliderToScale(this._slider.maximum)},_getActualMaxScaleAttr:function(){return this._scaleRanges.clampMaxScale(this.maxScale)},
_setMaxScaleAttr:function(a){this._set("maxScale",a);this._ensureScaleRangeProvider().then(l.hitch(this,function(){a=this._scaleRanges.clampMaxScale(a);this._set("maxScale",this._layerConstrainedMaxScale(a));this._silentSliderUpdate({maxScale:a});this._scheduleScaleRangeChangeEmit()}))},_silentSliderUpdate:function(a){var b=a.minScale,c=a.maxScale,g=this._scaleRanges;a=this._slider;void 0!==b&&(b=this._mapScaleToSlider(g.clampMinScale(b)),a.set("value",b,!1,!1));void 0!==c&&(b=this._mapScaleToSlider(g.clampMaxScale(c)),
a.set("value",b,!1,!0))},_mapScaleToSlider:function(a){var b=this._scaleRanges.scaleToRangeIndex(a),c=this._getSliderIndexRange(b),b=this._scaleRanges.findScaleRangeByIndex(b);return this._mapToRange(a,b.minScale,b.maxScale,c.min,c.max)},_getActualMinScaleAttr:function(){return this._scaleRanges.clampMinScale(this.minScale)},_setMinScaleAttr:function(a){this._set("minScale",a);this._ensureScaleRangeProvider().then(l.hitch(this,function(){a=this._scaleRanges.clampMinScale(a);this._set("minScale",this._layerConstrainedMinScale(a));
this._silentSliderUpdate({minScale:a});this._scheduleScaleRangeChangeEmit()}))},_ensureScaleRangeProvider:function(){if(this.map)return this._ensureMap();var a=new t;this.constraints&&a.resolve();return a.promise},_emitScaleRangeChange:function(){this.emit("scale-range-change",{minScale:this.minScale,maxScale:this.maxScale})},_layerConstrainedMinScale:function(a){var b=l.getObject("tileInfo.lods",!1,this.layer)||[],c;return 0<b.length?(b=b[0].scale,c=this._scaleRanges.get("firstRange"),(c=.85<this._mapToRange(a,
c.maxScale,c.minScale,0,1))?b:a>b?b:a):this._scaleRanges.beyondMinScale(a)?0:a},_layerConstrainedMaxScale:function(a){var b=l.getObject("tileInfo.lods",!1,this.layer)||[];return 0<b.length?(b=b[b.length-1].scale,a<b?b:a):this._scaleRanges.beyondMaxScale(a)?0:a},constructor:function(){this._scaleRanges=new (q.createSubclass([h]));this._scheduleScaleRangeChangeEmit=w(l.hitch(this,this._emitScaleRangeChange),0);this._ensureMap=l.hitch(this,this._ensureMap);this._ensureScaleRangeProvider=l.hitch(this,
this._ensureScaleRangeProvider);this._ensureLayer=l.hitch(this,this._ensureLayer);this._updateMinMaxScaleFromLayer=l.hitch(this,this._updateMinMaxScaleFromLayer);this._updateFromMap=l.hitch(this,this._updateFromMap)},buildRendering:function(){this.inherited(arguments);this._initSlider();this._initScalePreview();this._initCurrentScaleIndicator();this._initScaleMenus()},_initSlider:function(){var a=new (A.createSubclass([k]))({baseClass:"esriHorizontalSlider",showButtons:!1,intermediateChanges:this.intermediateChanges,
disabled:!0});this._slider=a;a.placeAt(this.domNode);a.startup();this.own(a.on("slide-onmousemove, slidemax-onmousemove",l.hitch(this,function(a){this._updateScalePreview(a.movable.handle)})),a.on("slide-onmovestop, slidemax-onmovestop",l.hitch(this,function(a){x.contains(a.movable.handle,"dijitSliderThumbHover")||this._closeScalePreview()})),a.on("change",l.hitch(this,function(){var a=Math.round(this._mapSliderToScale(this._getSliderMin())),b=Math.round(this._mapSliderToScale(this._getSliderMax()));
this.set({minScale:a,maxScale:b})})),v.after(a,"_setValueAttr",l.hitch(this,this._updateLabelMenus)))},_getSliderMin:function(){return this._slider.get("value")[0]},_getSliderMax:function(){return this._slider.get("value")[1]},_updateLabelMenus:function(){var a=this._maxScaleButton;this._minScaleButton.set("label",this._scaleRanges.getScaleRangeLabel(this._getSliderMin()));a.set("label",this._scaleRanges.getScaleRangeLabel(this._getSliderMax()))},_initScalePreview:function(){var b=new e;b.startup();
c.moveOffScreen(b);a.forEach([this._slider._movable.handle,this._slider._movableMax.handle],function(a){a.onmouseenter=l.hitch(this,this._updateScalePreview,a);a.onmouseleave=l.hitch(this,this._closeScalePreview)},this);this.own(b);this._scalePreview=b},_closeScalePreview:function(){c.close(this._scalePreview)},_updateScalePreview:function(a){if(!this.disabled){var b=this._scalePreview;c.moveOffScreen(b);var g=this._slider,d=a===g.sliderHandle?this._getSliderMin():this._getSliderMax(),l=u.position(a),
e=u.position(b.domNode),g=u.position(g.sliderBarContainer),r=this.isLeftToRight(),d=this._scaleRanges.getScalePreviewSpriteBackgroundPosition(d);b.set("backgroundPosition",d);l=l.x-g.x;e=.5*e.w;c.open({parent:this,popup:b,around:a,orient:l<e?r?["above","below"]:["above-alt","below-alt"]:l<g.w-e?["above-centered","below-centered"]:r?["above-alt","below-alt"]:["above","below"]})}},_initCurrentScaleIndicator:function(){if(this.map){var a=b.create("div",{className:this.css.scaleIndicatorContainer+" "+
this.css.currentScaleIndicatorContainer},this._slider.sliderBarContainer),c=b.create("div",{className:this.css.scaleIndicator+" "+this.css.currentScaleIndicator},a);this._currentScaleIndicator=c;this.createTooltip(c);a=z(c,"mouseover",l.hitch(this,function(){var a=y.substitute(this.labels.currentScaleTooltip,{scaleLabel:this._scaleRanges.getScaleRangeLabel(this._mapScaleToSlider(this.map.getScale()))});this.findTooltip(c).set("label",a)}));this.own(a)}},_initScaleMenus:function(){var a=new d,b=new d,
c,g;this.own(a.on("scale-selected",l.hitch(this,function(a){c.closeDropDown();this.set("minScale",a.scale)})));this.own(b.on("scale-selected",l.hitch(this,function(a){g.closeDropDown();this.set("maxScale",a.scale)})));c=new m({baseClass:"esriScaleMenuButton esriMinScaleMenuButton",dropDown:a,dropDownPosition:["below","above"]});c.toggleDropDown();c.toggleDropDown();g=new m({baseClass:"esriScaleMenuButton esriMaxScaleMenuButton",dropDown:b,dropDownPosition:["below","above"]});g.toggleDropDown();g.toggleDropDown();
this.own(v.before(c,"openDropDown",l.hitch(this,function(){var b=this._scaleRanges.findScaleRange(this.get("actualMaxScale")).minScale;a.set("options",{label:c.label,scale:{current:this.get("actualMinScale"),map:this._getMapScale(),min:this.get("minimum"),max:b}})})));this.own(v.before(g,"openDropDown",l.hitch(this,function(){var a=this._scaleRanges.findScaleRange(this.get("actualMinScale")).maxScale;b.set("options",{label:g.label,scale:{current:this.get("actualMaxScale"),map:this._getMapScale(),
min:a,max:this.get("maximum")}})})));c.placeAt(this.domNode);g.placeAt(this.domNode);a.startup();b.startup();c.startup();g.startup();this._minScaleButton=c;this._maxScaleButton=g},_getMapScale:function(){return this.map?this.map.getScale():-1},startup:function(){this.inherited(arguments);this.watch("intermediateChanges",function(a,b,c){this._slider.set(a,c)})}});r("extend-esri")&&l.setObject("dijit.VisibleScaleRangeSlider",n,p);return n})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip",
"dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(p,n,f,h,k){return f(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);this._started||n.forEach(this._tooltips,function(d){d.startup()})},destroy:function(){this.inherited(arguments);n.forEach(this._tooltips,function(d){d.destroy()});this._tooltips=null},createTooltips:function(d){n.forEach(d,function(d){this.createTooltip(d.node,
d.label)},this)},createTooltip:function(d,e){if(d=this._getConnectId(d))e="object"===typeof e?h.mixin({},e,{connectId:d}):{connectId:d,label:e},e=new p(e),this._started&&e.startup(),this._tooltips.push(e)},_getConnectId:function(d){var e,f;if(d){if(h.isArray(d)){if(e=[],n.forEach(d,function(d){(f=this._getNode(d))&&e.push(f)}),0===e.length)return}else if(e=this._getNode(d),!e)return;return e}},_getNode:function(d){return k.byId(d.domNode||d)},findTooltip:function(d){var e=this._getNode(d),f,m,c;if(d){d=
this._tooltips;f=d.length;for(var a=0;a<f;a++)if(m=d[a],c=h.isArray(m.connectId)?-1<n.indexOf(m.connectId,e):m.connectId===e)return m}}})})},"esri/dijit/VisibleScaleRangeSlider/_RecommendedScaleRangeBounds":function(){define(["./recommendedScales","dojo/_base/declare"],function(p,n){return n(null,{declaredClass:"esri.dijit.VisibleScaleRangeSlider._RecommendedScaleRangeBounds",beyondMinScale:function(f){var h=this.get("firstRange"),k=h.minScale,h=p.getRecommendedScale(h.id)||h.maxScale;return f<=k&&
f>h},beyondMaxScale:function(f){var h=this.get("lastRange"),k=h.maxScale,h=p.getRecommendedScale(h.id)||h.minScale;return f<h&&f>=k}})})},"esri/dijit/VisibleScaleRangeSlider/recommendedScales":function(){define(["dojo/_base/lang"],function(p){var n={_recommendedScales:{world:1E8,continent:5E7,countriesBig:25E6,countriesSmall:12E6,statesProvinces:6E6,stateProvince:3E6,counties:15E5,county:75E4,metropolitanArea:32E4,cities:16E4,city:8E4,town:4E4,neighborhood:2E4,streets:1E4,street:5E3,buildings:2500,
building:1250,smallBuilding:800,rooms:400,room:100},getRecommendedScale:function(f){return n._recommendedScales[f]},all:function(){return p.clone(n._recommendedScales)}};return n})},"esri/dijit/VisibleScaleRangeSlider/_SlideEvent":function(){define(["dojo/_base/array","dojo/_base/declare"],function(p,n){return n(null,{declaredClass:"esri.dijit.VisibleScaleRangeSlider._SlideEvent",_events:["onMouseMove","onFirstMove",{name:"onMoveStop",hookTo:"destroy"}],postCreate:function(){this.inherited(arguments);
this._extendMover(this._movable);this._extendMover(this._movableBar,"rangebar");this._extendMover(this._movableMax,"max")},_extendMover:function(f,h){if(f){var k=f.mover,d={};p.forEach(this._events,function(e){var n,m,c,a,l,v;"object"===typeof e?(m=e.name,n=e.hookTo):m=e;c=k.prototype[m]||function(){};a="slide"+(h||"")+"-"+m.toLowerCase();l=function(){c.apply(this,arguments);this.widget.emit(a,{movable:f})};n&&(v=k.prototype[n],d[n]=function(){v.apply(this,arguments);l.apply(this,arguments)});d[m]=
l});k.extend(d)}}})})},"esri/dijit/VisibleScaleRangeSlider/ScaleMenu":function(){define("../../kernel ../_EventedWidget ../_Tooltip ./recommendedScales ./ScaleRanges dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-prop dojo/dom-style dojo/has dojo/keys dojo/number dojo/on dojo/query dojo/string dojox/html/entities dojox/lang/functional/object dojo/i18n!../../nls/jsapi dojo/text!./templates/ScaleMenu.html dijit/form/TextBox".split(" "),
function(p,n,f,h,k,d,e,q,m,c,a,l,v,w,t,x,b,u,g,r,z,y,A,B){n=q([n,d,e,f],{declaredClass:"esri.dijit.VisibleScaleRangeSlider.ScaleMenu",templateString:B,baseClass:"esriScaleMenu",labels:A.widgets.visibleScaleRangeSlider,css:{header:"esriHeader",section:"esriSection",content:"esriContent",current:"esriCurrent",input:"esriInput",list:"esriList",item:"esriItem",inline:"esriInline",selectable:"esriSelectable",hidden:"esriHidden"},_elementValueMap:null,_elements:null,_scaleRangeCategories:null,_scaleRanges:null,
_rangeToScaleAndNodeLookup:null,constructor:function(){this._scaleRanges=new k},buildRendering:function(){this.inherited(arguments);this._rangeToScaleAndNodeLookup={map:{scale:null,node:this.dap_mapScaleItem}};var a=this.labels,b=a.featuredScaleLabels,c=h.all(),g=this.css.item+" "+this.css.selectable,d;m.forEach(y.keys(c),function(a){d=b[a];var e=c[a],f=r.substitute(d,{scaleLabel:this._formatScale(e)}),f=l.create("li",{innerHTML:f,className:g},this.dap_recommendedScales);this._rangeToScaleAndNodeLookup[a]=
{scale:e,node:f}},this);var e=l.create("span",{innerHTML:a.setTo,className:this.css.inline}),f=l.create("span",{innerHTML:a.selectOne,className:this.css.inline});v.set(this.dap_scaleListHeader,"innerHTML",r.substitute(a.setToSelectOne,{setTo:e.outerHTML,selectOne:f.outerHTML}))},_formatScale:function(a){return"1:"+b.format(a)},postCreate:function(){this.inherited(arguments);this.own(u(this.domNode,u.selector("."+this.css.item+"."+this.css.selectable,"click"),c.hitch(this,function(a){a=a.target===
this.dap_mapScaleItem?this.options.scale.map:this._parseScale(a.target.innerHTML);this._emitScaleSelected(a)})));this.dap_scaleInput.on("keyDown",c.hitch(this,function(a){a.keyCode===x.ENTER&&this._handleCustomScaleInput()}));this.createTooltip(this.dap_scaleInput,this.labels.customScaleInputTooltip)},_emitScaleSelected:function(a){this.emit("scale-selected",{scale:a})},_handleCustomScaleInput:function(){var a=this._parseScale(this.dap_scaleInput.get("value"));isNaN(a)||this._emitScaleSelected(this._scaleRanges.clampScale(a))},
_parseScale:function(a){a=z.decode(a).replace(/.*\(/,"").replace(/\).*$/,"").replace(/.*1:/,"").replace(/[^0-9.\s]/g,"");return b.parse(a)},_setOptionsAttr:function(b){var c=b.scale,g=this._formatScale(c.current);v.set(this.dap_currentScaleLabel,"innerHTML",b.label);this.dap_scaleInput.set("value",g,!1);g=r.substitute(this.labels.featuredScaleLabels.current,{scaleLabel:this._formatScale(c.map)});this._rangeToScaleAndNodeLookup.map.scale=c.map;v.set(this.dap_mapScaleItem,"innerHTML",g);a.toggle(this.dap_mapScaleItem,
this.css.hidden,-1===c.map);this._scaleRanges.set("scaleRangeBounds",{minScale:c.min,maxScale:c.max});this._hideOutOfScaleRanges();this._set("options",b)},_hideOutOfScaleRanges:function(){var b=g("."+this.css.item+"."+this.css.selectable,this.dap_recommendedScales),c=this._scaleRanges;m.forEach(y.keys(this._rangeToScaleAndNodeLookup),function(b){b=this._rangeToScaleAndNodeLookup[b];a.toggle(b.node,this.css.hidden,!c.contains(b.scale))},this);b=b.every(function(a){return"none"===w.get(a,"display")});
a.toggle(this.dap_recommendedScaleSection,this.css.hidden,b)}});t("extend-esri")&&c.setObject("dijit.ScaleMenu",n,p);return n})},"esri/dijit/VisibleScaleRangeSlider/ScaleRanges":function(){define(["./scalePreviewUtil","dojo/_base/array","dojo/_base/declare","dojo/Stateful","dojo/i18n!../../nls/jsapi"],function(p,n,f,h,k){f=f(h,{_scaleRangeStops:[{id:"room",minScale:100},{id:"rooms",minScale:400},{id:"smallBuilding",minScale:800},{id:"building",minScale:1999},{id:"buildings",minScale:3999},{id:"street",
minScale:7499},{id:"streets",minScale:14999},{id:"neighborhood",minScale:29999},{id:"town",minScale:59999},{id:"city",minScale:119999},{id:"cities",minScale:249999},{id:"metropolitanArea",minScale:499999},{id:"county",minScale:999999},{id:"counties",minScale:1999999},{id:"state",minScale:3999999},{id:"states",minScale:6999999},{id:"country",minScale:14999999},{id:"countries",minScale:34999999},{id:"continent",minScale:99999999},{id:"world",minScale:147914382}],_allRanges:null,_ranges:null,length:0,
constructor:function(){this._allRanges=this.getScaleRanges()},_scaleRangeBoundsSetter:function(d){this._ranges=d=this.getScaleRanges(d.maxScale,d.minScale);this.length=d.length},getScaleRanges:function(d,e){var f=this._scaleRangeStops,m=f.length,c,a,l;d=0<=d?d:0;e=0<e?e:f[m-1].minScale;c=d;a=[];for(var h=0;h<m;h++){var k=Math.min(f[h].minScale,e);l=Math.min(k,e);d<=k&&c<e&&a.push({id:f[h].id,maxScale:Math.max(c,d),minScale:l});c=l+1}a.reverse();return this._ensureValidBoundaryRanges(a)},_ensureValidBoundaryRanges:function(d){var e=
d[0];e.minScale===e.maxScale&&(d.shift(),d[0].minScale+=1);e=d[d.length-1];e.minScale===e.maxScale&&(d.pop(),--d[d.length-1].maxScale);return d},getScalePreviewSpriteBackgroundPosition:function(d){d=this._toFullRangeIndex(d);return p.getScalePreviewSpriteBackgroundPosition(d)},_toFullRangeIndex:function(d){d=this.findScaleRangeByIndex(Math.floor(d));for(var e=this._allRanges,f=e.length,m=0,c=0;c<f;c++)if(e[c].id===d.id){m=c;break}return m},getScaleRangeLabel:function(d){d=this._ranges[this._clampScaleRangeIndex(d)];
return k.widgets.visibleScaleRangeSlider.scaleRangeLabels[d.id]},findScaleRange:function(d){var e=this._ranges,f,m;if(d>=e[0].maxScale)return e[0];if(d<=e[e.length-1].minScale)return e[e.length-1];for(var c=0;c<e.length;c++)if(m=e[c],d>=m.maxScale&&d<=m.minScale){f=m;break}return f},findScaleRangeByIndex:function(d){d=this._clampScaleRangeIndex(d);return this._ranges[d]},clampScale:function(d){return Math.min(this.get("minScale"),Math.max(this.get("maxScale"),d))},_minScaleGetter:function(){return this.get("firstRange").minScale},
_maxScaleGetter:function(){return this.get("lastRange").maxScale},_firstRangeGetter:function(){return this._ranges[0]},_lastRangeGetter:function(){var d=this._ranges;return d[d.length-1]},clampMinScale:function(d){return 0===d?this.get("minScale"):this.clampScale(d)},clampMaxScale:function(d){return this.clampScale(d)},_clampScaleRangeIndex:function(d){if(0>=d)return 0;var e=this._ranges.length-1;return d>e?e:Math.floor(d)},scaleToRangeIndex:function(d){return n.indexOf(this._ranges,this.findScaleRange(d))},
contains:function(d){for(var e=this._ranges,f=!1,m,c=0;c<e.length;c++)if(m=e[c],d>=m.maxScale&&d<=m.minScale){f=!0;break}return f}});f.getScalePreviewSource=function(d){return p.getScalePreviewSource(d)};return f})},"esri/dijit/VisibleScaleRangeSlider/scalePreviewUtil":function(){define(["dojo/_base/array","require"],function(p,n){var f={_supportedRegions:"ar-iq ar-kw bg-bg cs-cz da-dk da-gl da-gl de-at de-ch de-de de-li el-gr en-ae en-au en-ca en-ca en-eg en-gb en-hk en-id en-ie en-ie en-il en-in en-iq en-ke en-lu en-mo en-my en-nz en-rw en-sg en-us en-us en-vi en-vi en-wo en-za es-ar es-ar es-bo es-bo es-cl es-cl es-co es-co es-cr es-cr es-es es-gt es-gt es-mx es-mx es-ni es-ni es-pe es-pe es-pr es-pr es-sv es-sv es-ve et-ee fi-fi fi-fi fr-ci fr-fr fr-ma fr-mg fr-ml fr-tn is-is is-is it-it ja-jp ja-jp ko-kr lt-lt lv-lv nl-be nl-nl nl-sr nl-sr nn-no nn-no pl-pl pt-br pt-br pt-pt ro-ro ru-ru sk-sk sv-se sv-se th-th zh-cn zh-tw".split(" "),
_defaultRegion:"en-us",_getSupportedRegion:function(h){h=h?h.toLowerCase():"";return-1<p.indexOf(f._supportedRegions,h)?h:f._defaultRegion},getScalePreviewSource:function(h){h="./images/scalePreview/"+f._getSupportedRegion(h)+".jpg";return"url("+n.toUrl(h)+")"},getScalePreviewSpriteBackgroundPosition:function(f){return"-"+f%5*128+"px -"+128*Math.floor(f/5)+"px"}};return f})},"dojox/lang/functional/object":function(){define(["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(p,n,f){var h={};
n.mixin(f,{keys:function(f){var d=[],e;for(e in f)e in h||d.push(e);return d},values:function(f){var d=[],e;for(e in f)e in h||d.push(f[e]);return d},filterIn:function(k,d,e){e=e||p.global;d=f.lambda(d);var n={},m,c;for(c in k)c in h||(m=k[c],d.call(e,m,c,k)&&(n[c]=m));return n},forIn:function(k,d,e){e=e||p.global;d=f.lambda(d);for(var n in k)n in h||d.call(e,k[n],n,k);return e},mapIn:function(k,d,e){e=e||p.global;d=f.lambda(d);var n={},m;for(m in k)m in h||(n[m]=d.call(e,k[m],m,k));return n}});return f})},
"dojox/lang/functional/lambda":function(){define(["../..","dojo/_base/lang","dojo/_base/array"],function(p,n,f){var h=n.getObject("lang.functional",!0,p),k={},d=1<"ab".split(/a*/).length?String.prototype.split:function(d){var c=this.split.call(this,d);(d=d.exec(this))&&0==d.index&&c.unshift("");return c},e=function(e){var c=[],a=d.call(e,/\s*->\s*/m);if(1<a.length)for(;a.length;)e=a.pop(),c=a.pop().split(/\s*,\s*|\s+/m),a.length&&a.push("(function("+c.join(", ")+"){ return ("+e+"); })");else if(e.match(/\b_\b/))c=
["_"];else{var a=e.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),l=e.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(a||l)a&&(c.push("$1"),e="$1"+e),l&&(c.push("$2"),e+="$2");else{var a=e.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,
"").match(/([a-z_$][a-z_$\d]*)/gi)||[],m={};f.forEach(a,function(a){m.hasOwnProperty(a)||(c.push(a),m[a]=1)})}}return{args:c,body:e}},q=function(d){return d.length?function(){var c=d.length-1,a=h.lambda(d[c]).apply(this,arguments);for(--c;0<=c;--c)a=h.lambda(d[c]).call(this,a);return a}:function(c){return c}};n.mixin(h,{rawLambda:function(d){return e(d)},buildLambda:function(d){d=e(d);return"function("+d.args.join(",")+"){return ("+d.body+");}"},lambda:function(d){if("function"==typeof d)return d;
if(d instanceof Array)return q(d);if(k.hasOwnProperty(d))return k[d];var c=e(d);return k[d]=new Function(c.args,"return ("+c.body+");")},clearLambdaCache:function(){k={}}});return h})},"esri/dijit/VisibleScaleRangeSlider/ScalePreview":function(){define("../../kernel dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has dojo/i18n!../../nls/jsapi dojo/text!./templates/ScalePreview.html".split(" "),function(p,n,f,h,k,d,e,q,m){n=h([f,n],{declaredClass:"esri.dijit.VisibleScaleRangeSlider.ScalePreview",
baseClass:"esriScalePreview",templateString:m,labels:q.widgets.visibleScaleRangeSlider,css:{header:"esriHeader",thumbnail:"esriThumbnail"},source:null,_setSourceAttr:function(c){this.source!==c&&(this._set("source",c),d.set(this.dap_scalePreviewThumbnail,"backgroundImage",c))},backgroundPosition:null,_setBackgroundPositionAttr:function(c){this.backgroundPosition!==c&&(this._set("backgroundPosition",c),d.set(this.dap_scalePreviewThumbnail,"backgroundPosition",c))}});e("extend-esri")&&k.setObject("dijit.ScalePreview",
n,p);return n})},"dojox/form/HorizontalRangeSlider":function(){define(["dojo/_base/declare","dojox/form/_RangeSliderMixin","dojo/text!./resources/HorizontalRangeSlider.html","dijit/form/HorizontalSlider"],function(p,n,f,h){return p("dojox.form.HorizontalRangeSlider",[h,n],{templateString:f})})},"dojox/form/_RangeSliderMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/_base/event dojo/_base/sniff dojo/dom-style dojo/dom-geometry dojo/keys dijit dojo/dnd/Mover dojo/dnd/Moveable dijit/form/_FormValueWidget dijit/focus dojo/fx dojox/fx".split(" "),
function(p,n,f,h,k,d,e,q,m,c,a,l,v,w,t){var x=function(a,b){return a-b};c=p("dojox.form._RangeSliderMixin",null,{_setTabIndexAttr:["sliderHandle","sliderHandleMax"],value:[0,100],postMixInProperties:function(){this.inherited(arguments);this.value=f.map(this.value,function(a){return parseInt(a,10)})},postCreate:function(){this.inherited(arguments);this.value.sort(x);var a=this,c=p(b,{constructor:function(){this.widget=a}});this._movableMax=new l(this.sliderHandleMax,{mover:c});this.sliderHandle.setAttribute("aria-valuemin",
this.minimum);this.sliderHandle.setAttribute("aria-valuemax",this.maximum);this.sliderHandleMax.setAttribute("aria-valuemin",this.minimum);this.sliderHandleMax.setAttribute("aria-valuemax",this.maximum);c=p(u,{constructor:function(){this.widget=a}});this._movableBar=new l(this.progressBar,{mover:c});this.focusNode.removeAttribute("aria-valuemin");this.focusNode.removeAttribute("aria-valuemax");this.focusNode.removeAttribute("aria-valuenow")},destroy:function(){this.inherited(arguments);this._movableMax.destroy();
this._movableBar.destroy()},_onKeyPress:function(a){if(!(this.disabled||this.readOnly||a.altKey||a.ctrlKey)){var b=a.target===this.sliderHandleMax,c=a.target===this.progressBar,d=n.delegate(m,this.isLeftToRight()?{PREV_ARROW:m.LEFT_ARROW,NEXT_ARROW:m.RIGHT_ARROW}:{PREV_ARROW:m.RIGHT_ARROW,NEXT_ARROW:m.LEFT_ARROW}),g=0,e=!1;switch(a.keyCode){case d.HOME:this._setValueAttr(this.minimum,!0,b);k.stop(a);return;case d.END:this._setValueAttr(this.maximum,!0,b);k.stop(a);return;case d.PREV_ARROW:case d.DOWN_ARROW:e=
!0;case d.NEXT_ARROW:case d.UP_ARROW:g=1;break;case d.PAGE_DOWN:e=!0;case d.PAGE_UP:g=this.pageIncrement;break;default:this.inherited(arguments);return}e&&(g=-g);g&&(c?this._bumpValue([{change:g,useMaxValue:!1},{change:g,useMaxValue:!0}]):this._bumpValue(g,b),k.stop(a))}},_onHandleClickMax:function(a){this.disabled||this.readOnly||(d("ie")||w.focus(this.sliderHandleMax),k.stop(a))},_onClkIncBumper:function(){this._setValueAttr(!1===this._descending?this.minimum:this.maximum,!0,!0)},_bumpValue:function(a,
b){a=n.isArray(a)?[this._getBumpValue(a[0].change,a[0].useMaxValue),this._getBumpValue(a[1].change,a[1].useMaxValue)]:this._getBumpValue(a,b);this._setValueAttr(a,!0,b)},_getBumpValue:function(a,b){var c=b?1:0;b=e.getComputedStyle(this.sliderBarContainer);var d=q.getContentBox(this.sliderBarContainer,b);b=this.discreteValues;c=this.value[c];if(1>=b||Infinity==b)b=d[this._pixelCount];b--;a=this.maximum>this.minimum?(c-this.minimum)*b/(this.maximum-this.minimum)+a:0;0>a&&(a=0);a>b&&(a=b);return a*(this.maximum-
this.minimum)/b+this.minimum},_onBarClick:function(a){this.disabled||this.readOnly||(d("ie")||w.focus(this.progressBar),k.stop(a))},_onRemainingBarClick:function(a){if(!this.disabled&&!this.readOnly){d("ie")||w.focus(this.progressBar);var b=q.position(this.sliderBarContainer,!0),c=q.position(this.progressBar,!0),g=a[this._mousePixelCoord],e=c[this._startingPixelCoord],c=e+c[this._pixelCount],e=this._isReversed()?g<=e:g>=c,g=this._isReversed()?b[this._pixelCount]-g+b[this._startingPixelCoord]:g-b[this._startingPixelCoord];
this._setPixelValue(g,b[this._pixelCount],!0,e);k.stop(a)}},_setPixelValue:function(a,b,c,d){this.disabled||this.readOnly||(a=this._getValueByPixelValue(a,b),this._setValueAttr(a,c,d))},_getValueByPixelValue:function(a,b){var c=this.discreteValues;if(1>=c||Infinity==c)c=b;c--;return(this.maximum-this.minimum)*Math.round((0>a?0:b<a?b:a)/(b/c))/c+this.minimum},_setValueAttr:function(a,b,c){var d=n.clone(this.value);n.isArray(a)?d=a:d[c?1:0]=a;this._lastValueReported="";this.valueNode.value=a=d;d.sort(x);
this.sliderHandle.setAttribute("aria-valuenow",d[0]);this.sliderHandleMax.setAttribute("aria-valuenow",d[1]);v.prototype._setValueAttr.apply(this,arguments);this._printSliderBar(b,c)},_printSliderBar:function(a,b){b=this.maximum>this.minimum?(this.value[0]-this.minimum)/(this.maximum-this.minimum):0;var c=this.maximum>this.minimum?(this.value[1]-this.minimum)/(this.maximum-this.minimum):0,d=b;b>c&&(b=c,c=d);var e=this._isReversed()?100*(1-b):100*b,g=this._isReversed()?100*(1-c):100*c,f=this._isReversed()?
100*(1-c):100*b;if(a&&0<this.slideDuration&&this.progressBar.style[this._progressPixelSize]){if(parseFloat(this.progressBar.style[this._handleOffsetCoord]),a=this.slideDuration/10,0!==a){0>a&&(a=0-a);var l={},k={},d={};l[this._handleOffsetCoord]={start:this.sliderHandle.parentNode.style[this._handleOffsetCoord],end:e,units:"%"};k[this._handleOffsetCoord]={start:this.sliderHandleMax.parentNode.style[this._handleOffsetCoord],end:g,units:"%"};d[this._handleOffsetCoord]={start:this.progressBar.style[this._handleOffsetCoord],
end:f,units:"%"};d[this._progressPixelSize]={start:this.progressBar.style[this._progressPixelSize],end:100*(c-b),units:"%"};b=h.animateProperty({node:this.sliderHandle.parentNode,duration:a,properties:l});c=h.animateProperty({node:this.sliderHandleMax.parentNode,duration:a,properties:k});a=h.animateProperty({node:this.progressBar,duration:a,properties:d});t.combine([b,c,a]).play()}}else this.sliderHandle.parentNode.style[this._handleOffsetCoord]=e+"%",this.sliderHandleMax.parentNode.style[this._handleOffsetCoord]=
g+"%",this.progressBar.style[this._handleOffsetCoord]=f+"%",this.progressBar.style[this._progressPixelSize]=100*(c-b)+"%"}});var b=p("dijit.form._SliderMoverMax",a,{onMouseMove:function(a){var b=this.widget,c=b._abspos;c||(c=b._abspos=q.position(b.sliderBarContainer,!0),b._setPixelValue_=n.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-c[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?c[b._pixelCount]-a:a,c[b._pixelCount],!1,!0)},destroy:function(b){a.prototype.destroy.apply(this,
arguments);var c=this.widget;c._abspos=null;c._setValueAttr(c.value,!0)}}),u=p("dijit.form._SliderBarMover",a,{onMouseMove:function(a){var b=this.widget;if(!b.disabled&&!b.readOnly){var c=b._abspos,d=b._bar,e=b._mouseOffset;c||(c=b._abspos=q.position(b.sliderBarContainer,!0),b._setPixelValue_=n.hitch(b,"_setPixelValue"),b._getValueByPixelValue_=n.hitch(b,"_getValueByPixelValue"),b._isReversed_=b._isReversed());d||(d=b._bar=q.position(b.progressBar,!0));e||(e=b._mouseOffset=a[b._mousePixelCoord]-d[b._startingPixelCoord]);
a=a[b._mousePixelCoord]-c[b._startingPixelCoord]-e;pixelValues=[a,a+d[b._pixelCount]];pixelValues.sort(x);0>=pixelValues[0]&&(pixelValues[0]=0,pixelValues[1]=d[b._pixelCount]);pixelValues[1]>=c[b._pixelCount]&&(pixelValues[1]=c[b._pixelCount],pixelValues[0]=c[b._pixelCount]-d[b._pixelCount]);c=[b._getValueByPixelValue(b._isReversed_?c[b._pixelCount]-pixelValues[0]:pixelValues[0],c[b._pixelCount]),b._getValueByPixelValue(b._isReversed_?c[b._pixelCount]-pixelValues[1]:pixelValues[1],c[b._pixelCount])];
b._setValueAttr(c,!1,!1)}},destroy:function(){a.prototype.destroy.apply(this,arguments);var b=this.widget;b._abspos=null;b._bar=null;b._mouseOffset=null;b._setValueAttr(b.value,!0)}});return c})},"dojox/fx":function(){define(["./fx/_base"],function(p){return p})},"dojox/fx/_base":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/fx dojo/fx dojo/dom dojo/dom-style dojo/dom-geometry dojo/_base/connect dojo/_base/html".split(" "),function(p,n,f,h,k,d,e,q,m){p=n.getObject("dojox.fx",!0);
n.mixin(p,{anim:f.anim,animateProperty:f.animateProperty,fadeTo:f._fade,fadeIn:f.fadeIn,fadeOut:f.fadeOut,combine:h.combine,chain:h.chain,slideTo:h.slideTo,wipeIn:h.wipeIn,wipeOut:h.wipeOut});p.sizeTo=function(c){var a=c.node=k.byId(c.node),e=c.method||"chain";c.duration||(c.duration=500);"chain"==e&&(c.duration=Math.floor(c.duration/2));var m,p,t,x,b,q=null,g=function(a){return function(){var e=d.getComputedStyle(a),f=e.position,l=e.width,g=e.height;m="absolute"==f?a.offsetTop:parseInt(e.top)||0;
t="absolute"==f?a.offsetLeft:parseInt(e.left)||0;b="auto"==l?0:parseInt(l);q="auto"==g?0:parseInt(g);x=t-Math.floor((c.width-b)/2);p=m-Math.floor((c.height-q)/2);"absolute"!=f&&"relative"!=f&&(e=d.coords(a,!0),m=e.y,t=e.x,a.style.position="absolute",a.style.top=m+"px",a.style.left=t+"px")}}(a),a=f.animateProperty(n.mixin({properties:{height:function(){g();return{end:c.height||0,start:q}},top:function(){return{start:m,end:p}}}},c)),e=f.animateProperty(n.mixin({properties:{width:function(){return{start:b,
end:c.width||0}},left:function(){return{start:t,end:x}}}},c));return h["combine"==c.method?"combine":"chain"]([a,e])};p.slideBy=function(c){var a,l,h=function(c){return function(){var f=d.getComputedStyle(c),h=f.position;a="absolute"==h?c.offsetTop:parseInt(f.top)||0;l="absolute"==h?c.offsetLeft:parseInt(f.left)||0;"absolute"!=h&&"relative"!=h&&(f=e.coords(c,!0),a=f.y,l=f.x,c.style.position="absolute",c.style.top=a+"px",c.style.left=l+"px")}}(c.node=k.byId(c.node));h();c=f.animateProperty(n.mixin({properties:{top:a+
(c.top||0),left:l+(c.left||0)}},c));q.connect(c,"beforeBegin",c,h);return c};p.crossFade=function(c){var a=c.nodes[0]=k.byId(c.nodes[0]),d=m.style(a,"opacity"),e=c.nodes[1]=k.byId(c.nodes[1]);m.style(e,"opacity");return h.combine([f[0==d?"fadeIn":"fadeOut"](n.mixin({node:a},c)),f[0==d?"fadeOut":"fadeIn"](n.mixin({node:e},c))])};p.highlight=function(c){var a=c.node=k.byId(c.node);c.duration=c.duration||400;var d=c.color||"#ffff99",e=m.style(a,"backgroundColor");"rgba(0, 0, 0, 0)"==e&&(e="transparent");
c=f.animateProperty(n.mixin({properties:{backgroundColor:{start:d,end:e}}},c));"transparent"==e&&q.connect(c,"onEnd",c,function(){a.style.backgroundColor=e});return c};p.wipeTo=function(c){c.node=k.byId(c.node);var a=c.node,d=a.style,e=c.width?"width":"height",h={};h[e]={start:function(){d.overflow="hidden";if("hidden"==d.visibility||"none"==d.display)return d[e]="1px",d.display="",d.visibility="",1;var c=m.style(a,e);return Math.max(c,1)},end:c[e]};return f.animateProperty(n.mixin({properties:h},
c))};return p})},"widgets/LayerList/NlsStrings":function(){define([],function(){return{value:null}})},"widgets/LayerList/PopupMenuInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all jimu/WidgetManager jimu/portalUrlUtils esri/lang ./NlsStrings".split(" "),function(p,n,f,h,k,d,e,q,m){var c=p([],{_candidateMenuItems:null,_displayItems:null,_layerInfo:null,_layerType:null,_appConfig:null,constructor:function(a,c,d,e){this.nls=m.value;this._layerInfo=
a;this._layerType=d;this.layerListWidget=e;this._initCandidateMenuItems();this._initDisplayItems(c)},_getATagLabel:function(){var a,c;a=this._layerInfo.getUrl();(c=this._layerInfo.isItemLayer())?(a=this._getItemDetailsPageUrl(c)||a,c=this.nls.itemShowItemDetails):!a||"CSVLayer"!==this._layerType&&"KMLLayer"!==this._layerType?(a=a&&"WMSLayer"===this._layerType?a+(-1<a.indexOf("?")?"\x26":"?")+"SERVICE\x3dWMS\x26REQUEST\x3dGetCapabilities":a&&"WFSLayer"===this._layerType?a+(-1<a.indexOf("?")?"\x26":
"?")+"SERVICE\x3dWFS\x26REQUEST\x3dGetCapabilities":a?a:"",c=this.nls.itemDesc):c=this.nls.itemDownload;this._ATagLabelUrl=a;return'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d"'+a+'"\x3e'+c+"\x3c/a\x3e"},_getItemDetailsPageUrl:function(a){var c="";return c=e.getItemDetailsPageUrl(a.portalUrl,a.itemId)},_initCandidateMenuItems:function(){this._candidateMenuItems=[{key:"separator",label:""},{key:"empty",label:this.nls.empty},{key:"zoomto",label:this.nls.itemZoomTo},{key:"transparency",
label:this.nls.itemTransparency},{key:"setVisibilityRange",label:this.nls.itemSetVisibilityRange},{key:"moveup",label:this.nls.itemMoveUp},{key:"movedown",label:this.nls.itemMoveDown},{key:"table",label:this.nls.itemToAttributeTable},{key:"controlPopup",label:this.nls.removePopup},{key:"controlLabels",label:this.nls.showLabels},{key:"url",label:this._getATagLabel()}]},_initDisplayItems:function(a){this._displayItems=[];n.forEach(a,function(a){n.forEach(this._candidateMenuItems,function(c){a.key===
c.key&&(this._displayItems.push(f.clone(c)),a.onClick&&(this._displayItem.onClick=a.onClick))},this)},this)},_isSupportedByAT:function(){return!0},_isSupportedByAT_bk:function(a,c){a=a.config;a=0===a.layerInfos.length?!0:n.some(a.layerInfos,function(a){if(a.id===this._layerInfo.id&&a.show)return!0},this);return c.isSupportedLayer&&c.isSupportQuery&&!c.otherReasonCanNotSupport&&a?!0:!1},getDeniedItems:function(){var a=new h,c=[];this.layerListWidget.layerListView.isFirstDisplayedLayerInfo(this._layerInfo)&&
c.push({key:"moveup",denyType:"disable"});this.layerListWidget.layerListView.isLastDisplayedLayerInfo(this._layerInfo)&&c.push({key:"movedown",denyType:"disable"});this._ATagLabelUrl||c.push({key:"url",denyType:"disable"});this._layerInfo.canShowLabel()||c.push({key:"controlLabels",denyType:"hidden"});this._layerInfo.originOperLayer.featureCollection?c.push({key:"setVisibilityRange",denyType:"hidden"}):this._layerInfo.isRootLayer()||"esri.layers.ArcGISTiledMapServiceLayer"!==this._layerInfo.getRootLayerInfo().layerObject.declaredClass?
this._layerInfo.isRootLayer()||"esri.layers.ArcGISDynamicMapServiceLayer"!==this._layerInfo.getRootLayerInfo().layerObject.declaredClass||this._layerInfo.getRootLayerInfo().layerObject.supportsDynamicLayers||c.push({key:"setVisibilityRange",denyType:"disable"}):c.push({key:"setVisibilityRange",denyType:"hidden"});var d=this._layerInfo.loadInfoTemplate(),e=this._layerInfo.getSupportTableInfo();k({infoTemplate:d,supportTableInfo:e}).then(f.hitch(this,function(d){d.infoTemplate||c.push({key:"controlPopup",
denyType:"disable"});d=d.supportTableInfo;var e=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];e&&e.visible?this._isSupportedByAT(e,d)||(this._layerInfo.parentLayerInfo&&this._layerInfo.parentLayerInfo.isMapNotesLayerInfo()?c.push({key:"table",denyType:"hidden"}):c.push({key:"table",denyType:"disable"})):c.push({key:"table",denyType:"hidden"});a.resolve(c)}),function(){a.resolve(c)});return a},getDisplayItems:function(){return this._displayItems},onPopupMenuClick:function(a){var c=
{closeMenu:!0};switch(a.itemKey){case "zoomto":this._onItemZoomToClick(a);break;case "moveup":this._onMoveUpItemClick(a);break;case "movedown":this._onMoveDownItemClick(a);break;case "table":this._onTableItemClick(a);break;case "transparencyChanged":this._onTransparencyChanged(a);c.closeMenu=!1;break;case "controlPopup":this._onControlPopup();break;case "controlLabels":this._onControlLabels()}return c},_onItemZoomToClick:function(a){this._layerInfo.zoomTo()},_isValidExtent:function(a){var c=!1;q.isDefined(a)&&
q.isDefined(a.xmin)&&isFinite(a.xmin)&&q.isDefined(a.ymin)&&isFinite(a.ymin)&&q.isDefined(a.xmax)&&isFinite(a.xmax)&&q.isDefined(a.ymax)&&isFinite(a.ymax)&&(c=!0);return c},_onMoveUpItemClick:function(a){this._layerInfo.isFirst||a.layerListView.moveUpLayer(this._layerInfo)},_onMoveDownItemClick:function(a){this._layerInfo.isLast||a.layerListView.moveDownLayer(this._layerInfo)},_onTableItemClick:function(a){this._layerInfo.getSupportTableInfo().then(f.hitch(this,function(c){var e=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];
this._isSupportedByAT(e,c)&&(c=d.getInstance(),c.triggerWidgetOpen(e.id).then(f.hitch(this,function(){a.layerListWidget.publishData({target:"AttributeTable",layer:this._layerInfo})})))}))},_onTransparencyChanged:function(a){this._layerInfo.setOpacity(1-a.extraData.newTransValue)},_onControlPopup:function(a){this._layerInfo.controlPopupInfo.enablePopup?this._layerInfo.disablePopup():this._layerInfo.enablePopup();this._layerInfo.map.infoWindow.hide()},_onControlLabels:function(a){this._layerInfo.canShowLabel()&&
(this._layerInfo.isShowLabels()?this._layerInfo.hideLabels():this._layerInfo.showLabels())}});c.create=function(a,d){var e=new h,k=a.isRootLayer(),m={RootLayer:[{key:"zoomto"},{key:"transparency"},{key:"setVisibilityRange"},{key:"separator"},{key:"moveup"},{key:"movedown"},{key:"separator"},{key:"url"}],RootLayerAndFeatureLayer:[{key:"zoomto"},{key:"transparency"},{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"controlLabels"},{key:"separator"},{key:"moveup"},
{key:"movedown"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],FeatureLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],SublayerOfDynamicMapserviceLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"url"}],GroupLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"url"}],Table:[{key:"table"},{key:"separator"},{key:"url"}],BasemapLayer:[{key:"zoomto"},{key:"transparency"},{key:"separator"},
{key:"url"}],"default":[{key:"url",onClick:null}]};a.getLayerType().then(f.hitch(this,function(f){var b="",b=a.isBasemap()&&a.isRootLayer()?"BasemapLayer":a.isBasemap()?"default":!k||"FeatureLayer"!==f&&"CSVLayer"!==f&&"ArcGISImageServiceLayer"!==f&&"StreamLayer"!==f&&"ArcGISImageServiceVectorLayer"!==f?k?"RootLayer":"FeatureLayer"===f||"CSVLayer"===f?"FeatureLayer":a.isLeaf()&&a.getRootLayerInfo()&&a.getRootLayerInfo().layerObject&&"esri.layers.ArcGISDynamicMapServiceLayer"===a.getRootLayerInfo().layerObject.declaredClass?
"SublayerOfDynamicMapserviceLayer":"GroupLayer"===f?"GroupLayer":"Table"===f?"Table":"default":"RootLayerAndFeatureLayer";e.resolve(new c(a,m[b],f,d))}),f.hitch(this,function(){e.resolve(new c(a,[{key:"empty"}]))}));return e};return c})},"widgets/LayerList/LayerFilter":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dijit/_TemplatedMixin dojo/text!./LayerFilter.html dojo/dom dojo/dom-class jimu/dijit/Search".split(" "),function(p,n,f,h,k,d,e,q){return n([p,h],{templateString:k,
baseClass:"layer-filter",layerFilterInput:null,isValid:!1,layerListWidget:null,layerInfoIsValidStatus:null,layerInfoIsExpandStatus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=f.mixin(f.clone(this.layerListWidget.nls),window.jimuNls.common)},constructor:function(){this.layerInfoIsValidStatus={};this.layerInfoIsExpandStatus={}},startup:function(){this.layerFilterInput=(new q({placeholder:this.nls.typeAKeywork,onSearch:f.hitch(this,this._onFilter),searchWhenInput:!0})).placeAt(this.searchInputNode);
d.setSelectable(this.cancelButton,!1)},_updateLayerInfoStatus:function(d){this.layerInfoIsValidStatus={};this.layerInfoIsExpandStatus={};this.layerListWidget.operLayerInfos.traversalAll(f.hitch(this,function(c){if(d){var a;if(0<=c.title.toLowerCase().indexOf(d.toLowerCase()))for(a=c;a;)this.layerInfoIsValidStatus[a.id]=!0,(a=a.parentLayerInfo)&&(this.layerInfoIsExpandStatus[a.id]=!0);else for(a=c.parentLayerInfo;a;){if(0<=a.title.toLowerCase().indexOf(d.toLowerCase())){this.layerInfoIsValidStatus[c.id]=
!0;break}a=a.parentLayerInfo}}else this.layerInfoIsValidStatus[c.id]=!0}))},isValidLayerInfo:function(d){return!this.isValid||this.layerInfoIsValidStatus[d.id]},isExpanded:function(d){return this.isValid&&this.layerInfoIsExpandStatus[d.id]},cancelFilter:function(){this.isValid=!1;this.layerFilterInput.inputSearch.value&&(this.layerFilterInput.inputSearch.value="",this.layerListWidget._refresh());e.remove(this.searchButton,"invalid");e.add(this.searchInputNode,"invalid");e.add(this.cancelButton,"invalid")},
_onFilter:function(d){d?e.remove(this.clearInputButton,"disable"):e.add(this.clearInputButton,"disable");this._updateLayerInfoStatus(d);this.layerListWidget._refresh()},_onSearchBtnClick:function(){this.isValid=!0;e.add(this.searchButton,"invalid");e.remove(this.searchInputNode,"invalid");e.remove(this.cancelButton,"invalid");this.layerFilterInput.inputSearch.focus()},_onCancelBtnClick:function(){this.cancelFilter()},_onClearInputButton:function(){this.layerFilterInput.inputSearch.value&&(e.add(this.clearInputButton,
"disable"),this.layerFilterInput.inputSearch.focus(),this.layerFilterInput.inputSearch.value="",this._updateLayerInfoStatus(""),this.layerListWidget._refresh())}})})},"widgets/LayerList/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/LayerList/PopupMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"popup-menu-transparency-body" data-dojo-attach-point\x3d"transparencyDiv" data-dojo-attach-event\x3d"onclick:_onTransparencyDivClick" \x3e\r\n    \x3cdiv class\x3d"label"\x3e\r\n      \x3cdiv class\x3d"label-left jimu-float-leading"\x3e${nls.itemOpaque}\x3c/div\x3e\r\n      \x3cdiv class\x3d"label-right jimu-float-trailing"\x3e${nls.itemTransparent}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"transparencyBody"\x3e \r\n      \x3col data-dojo-attach-point\x3d"transparencyRule" class\x3d"transparency-rule"\x3e \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"popup-menu-visible-scale-range-body" data-dojo-attach-point\x3d"setVisibilityRangeNode" data-dojo-attach-event\x3d"onclick:_onSetVisibilityRangeNode"\x3e \r\n  \x3c/div\x3e\r\n\x3cdiv\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScaleMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.section}"\x3e\r\n    \x3cdiv class\x3d"${css.header}"\x3e${labels.current}\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_currentScaleLabel" class\x3d"${css.item} ${css.current}"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_scaleInput" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${css.input}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recommendedScaleSection"\x3e\r\n    \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_scaleListHeader"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3col data-dojo-attach-point\x3d"dap_recommendedScales" class\x3d"${css.list}"\x3e\r\n        \x3cli data-dojo-attach-point\x3d"dap_mapScaleItem" class\x3d"${css.item} ${css.selectable}"\x3e\x3c/li\x3e\r\n        \x3c!--additional list items added dynamically--\x3e\r\n      \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScalePreview.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.header}"\x3e${labels.preview}\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dap_scalePreviewThumbnail" class\x3d"${css.thumbnail}"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:dojox/form/resources/HorizontalRangeSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onkeyup:_onKeyUp" role\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" dojoAttachEvent\x3d"onmousedown:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput dojoAttachPoint\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv role\x3d"presentation" class\x3d"dojoxRangeSliderBarContainer" dojoAttachPoint\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandle,focusNode" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" dojoAttachEvent\x3d"onmousedown:_onBarClick"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandleMax" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClickMax" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" dojoAttachEvent\x3d"onmousedown:_onRemainingBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" dojoAttachEvent\x3d"onmousedown:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:widgets/LayerList/LayerListView.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layer-list-operations" data-dojo-attach-point\x3d"layerListOperations"\x3e\r\n    \x3c!--div class\x3d"setting-image jimu-icon jimu-icon-setting jimu-state-disabled"\x3e\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3ctable class\x3d"layer-list-table"\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"layerListTable"\x3e\x3c/tbody\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"tableListTable"\x3e\x3c/tbody\x3e       \r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/LayerFilter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"search-input-node invalid" data-dojo-attach-point\x3d"searchInputNode"\x3e\r\n    \x3cdiv class\x3d"clear-input-button disable" data-dojo-attach-point\x3d"clearInputButton" data-dojo-attach-event\x3d"click:_onClearInputButton"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-button" data-dojo-attach-point\x3d"searchButton" data-dojo-attach-event\x3d"click:_onSearchBtnClick"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"cancel-button invalid" data-dojo-attach-point\x3d"cancelButton" data-dojo-attach-event\x3d"click:_onCancelBtnClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layers-section" data-dojo-attach-point\x3d"layersSection"\x3e\r\n    \x3cdiv class\x3d"layer-list-title" data-dojo-attach-point\x3d"layerListTitle"\x3e${nls.layers}\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-filter-node" data-dojo-attach-point\x3d"layerFilterNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-list-body" data-dojo-attach-point\x3d"layerListBody"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/LayerList/css/style.css":'.jimu-widget-layerList{position: relative;}.jimu-widget-layerList .jimu-hr{margin-top: 15px;}.jimu-widget-layerList .layers-section{margin-top: 0px; z-index: 0; position: relative;}.jimu-widget-layerList .layers-section .layers-list{width: 100%;}.jimu-widget-layerList .layers-section .layer-list-title{height: 16px; font-size: 14px; margin-bottom: 14px; font-family: "Avenir Heavy"; margin-left: 8px; margin-right: 8px;}.jimu-widget-layerList .layers-section .layer-list-title.disable{margin-bottom: 2px;}.jimu-widget-layerList .layer-list-body {}.jimu-widget-layerList .layer-list-table{width: 100%; border-spacing: 0px;}.jimu-widget-layerList .layers-list-body{border: 0px solid #999;}.jimu-widget-layerList .jimu-widget-row{}.jimu-widget-layerList .layer-row{height: 40px;}.jimu-widget-layerList .layer-row:hover{background-color: #e3ecf2;}.jimu-widget-layerList .layer-row-mouseover{background-color: #e3ecf2;}.jimu-widget-layerList .jimu-widget-row-selected{background-color: #d9dde0;}.jimu-widget-layerList .jimu-widget-row-active{background-color: #009cff;}.jimu-widget-layerList .jimu-widget-row-selected .col-layer-label{color: #333;}.jimu-widget-layerList .jimu-widget-row-active .col-layer-label{color: #fff;}.jimu-widget-layerList .col{border: 0px solid; border-bottom: 0px solid #ffffff;}.jimu-widget-layerList .col1{}.jimu-widget-layerList .col2{width: auto; word-break: break-word; cursor: pointer;}.jimu-widget-layerList .col3{width: 24px;}.jimu-widget-layerList .begin-blank-div{width: 12px; height: 2px;}.jimu-widget-layerList .col-showLegend{width: 17px; text-align: center;}.jimu-widget-layerList .showLegend-div{width: 13px; height: 13px; cursor: pointer; margin-left: 3px; margin-top: 3px; background-image: url("../images/v_right.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .jimu-widget-layerList .showLegend-div{background-image: url("../images/v_left.png"); margin-left: 0; margin-right: 3px;} .jimu-widget-layerList .showLegend-div.unfold{background-image: url("../images/v.png");}.jimu-widget-layerList .showLegend-div.hidden{background-image: none; cursor: auto;}.jimu-widget-layerList .layers-list-imageShowLegend-down{-moz-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -webkit-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -o-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -ms-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);}.jimu-widget-layerList .layers-list-imageShowLegend-down-div{background-color: #d9dde0;}.jimu-widget-layerList .noLegend-div{width: 33px; text-align: right; display: none;}.jimu-widget-layerList .noLegend-image{display: block; margin: 0 auto;}.jimu-widget-layerList .col-blank{width:17px;}.jimu-widget-layerList .col-select{width: 17px;}.jimu-widget-layerList .col-reserve-blank{width: 25px;}.jimu-widget-layerList .col-content{color: #686868; font-size: 12px;}.jimu-widget-layerList .div-select{position: relative; font-size: 2px;}.jimu-widget-layerList .div-select .checkbox{cursor: auto;}.jimu-widget-layerList .image-group-div {width: 14px; height: 14px; background-image: url("../images/group_layer.svg"); background-repeat: no-repeat; background-position: center center; background-size: 14px; margin: 1px 0 0 2px; cursor: auto;}.jimu-rtl .jimu-widget-layerList .image-group-div {margin-left: 4px; margin-right: auto;}.jimu-widget-layerList .image-group-div.disable{display: none;}.jimu-widget-layerList .div-content{position: relative; font-size: 12px; border: 0px solid;}.jimu-widget-layerList .div-content.grayed-title{opacity: 0.3;}.jimu-widget-layerList .col-popupMenu{width: 17px; text-align: center;}.jimu-widget-layerList .col-select .jimu-selection-box{margin-top: 5px;}.jimu-widget-layerList .layers-list-body .col-layer-label{color: #686868;}.jimu-widget-layerList .layer-sub-node{display: none; width:100%; border-spacing: 0px;}.jimu-widget-layerList .legend-node-td{}.jimu-widget-layerList .legend-div{overflow: hidden; font-size: 11px;}.jimu-widget-layerList .legend-symbol{}.jimu-widget-layerList .legend-label{margin-top: 17px; color: #686868; font-size: 11px;}.jimu-widget-layerList .esriLegendService {padding-bottom: 0;}.jimu-widget-layerList .esriLegendLayerLabel {padding-top: 0; height: 0; display: none;}.jimu-widget-layerList .esriLegendServiceLabel {display: none;}.jimu-widget-layerList .esriLegendLayer{font-size: 12px;}.jimu-widget-layerList .esriLegendMsg{display: none;}.jimu-widget-layerList .layers-list-popupMenu-div{position: relative; width: 22px; height: 40px; cursor: pointer; border-radius: 2px; float: right; padding-top: 14px; background-image: url("../images/more_normal.svg"); background-repeat: no-repeat; background-position: center 23px;}.jimu-widget-layerList .layers-list-popupMenu-div:hover{background-image: url("../images/more_hover.svg");}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-button{background: none;}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-button:hover{background: none;}.jimu-widget-layerList .layers-list-popupMenu-div .loading-section {width: 17px; height: 17px; top: 14px; left: 2px; z-index: 1; margin: 0;} .jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .loading-section {left: auto; right: 2px;}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-loading{width: 17px; height: 17px; margin: -9px 0 0 2px; border-radius: 25px; background-image: url("../images/loading.gif"); background-repeat: no-repeat; background-position: center center; background-size: contain;}.jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-loading{}.jimu-widget-layerList .layers-list-popupMenu-div-selected{width: 13px; height: 13px; background-color: #ffffff; border-radius: 2px;}.jimu-widget-layerList .layers-list-popupMenu-image{position: absolute; top: 5px; left: 3px;}.jimu-widget-layerList .popup-menu-transparency-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 290px; height:50px; padding-left: 5px; padding-right: 5px; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderImageHandleH{background: url(./images/slider-handle.png); width: 10px; border: none; height: 14px;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderBar {background: #ddd none; border-color: #999;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderBar {background: #ddd none; border-color: #999;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderDecrementIconH, .jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderIncrementIconH {background-color: #ddd; border: solid 1px #b5bcc7;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderDecrementIconH,.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderIncrementIconH {background-color: #ddd; border: solid 1px #b5bcc7;}.jimu-widget-layerList .popup-menu-transparency-body .transparency-rule{}.jimu-widget-layerList .popup-menu-transparency-body .label {overflow: hidden; margin-top: 2px; margin-bottom: 1px;}.jimu-widget-layerList .popup-menu-visible-scale-range-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 290px; height:50px; padding-left: 5px; padding-right: 5px; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-visible-scale-range-body .esriVisibleScaleRangeSlider{margin-top: 15px;}.jimu-widget-layerList .jimu-dropmenu .popup-menu-button{width: 22px; height: 22px;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn{width: 22px; height: 22px; min-width: 13px; background-image: url("../images/more_normal.svg"); background-color: rgba(255, 255, 255, 0); border: 0 solid;}.jimu-widget-layerList .layers-list-popupMenu-div:hover .jimu-icon-btn{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn-selected{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu{min-width: 180px; max-width: 330px; outline-color:#ffffff; outline-style:solid; outline-width:1px; overflow:auto; font-size: 12px; z-index: 2; right: 0px; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .jimu-dropmenu .drop-menu.no-border{outline-style: none; border: none; box-shadow: none;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .drop-menu{left: 0px;}.jimu-widget-layerList .jimu-dropmenu .menu-item{position: relative; height: 40px; line-height: 40px; white-space: nowrap; padding: 0px 24px; margin: 0 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-layerList .jimu-dropmenu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .jimu-dropmenu .menu-item-dissable{opacity: 0.4;}.jimu-widget-layerList .jimu-dropmenu .menu-item-hidden{display: none;}.jimu-widget-layerList .jimu-dropmenu .menu-item a{width: 100%;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .menu-item a{right: auto; left: 0;}.jimu-widget-layerList .legends-loading-img{width: 45px;}.jimu-widget-layerList .jimu-dropmenu .menu-item .menu-item-description{text-decoration: none; color: inherit; display: block;}.jimu-widget-layerList .layer-list-operations{position: absolute; right: 0; top: 0;}.jimu-rtl .jimu-widget-layerList .layer-list-operations{right: auto; left: 0;}.jimu-widget-layerList .layer-list-operations .setting-image{position: relative; right: 11px; top: -1px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .setting-image{right: auto; left: 11px;}.jimu-widget-layerList .layer-list-operations .jimu-icon-btn{background-image: url("../images/operation_normal.svg"); background-color: rgba(255, 255, 255, 0);}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-icon-btn{left: auto; right: -8px;}.jimu-widget-layerList .layer-list-operations:hover .jimu-icon-btn{background-image: url("../images/operation_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .layer-list-operations .drop-menu{min-width:147px !important; top: 21px !important; right: 0 !important; left: auto !important; z-index: 1 !important; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none !important;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .drop-menu{right: auto !important; left: 0 !important;}.jimu-widget-layerList .layer-list-operations .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item{margin: 0; padding: 0 7px; font-size: 12px; padding: 0 20px;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .layer-list-operations .jimu-loading{font-size: 5px; top: 45px; left: 20px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-loading{left: auto; right: 20px;}.jimu-widget-layerList .layer-filter-node{position: absolute; width: 100%; top: 0;}.jimu-widget-layerList .layer-filter{position: relative;}.jimu-widget-layerList .layer-filter .search-input-node{position: absolute; top: -10px; left: 0; right: 74px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node{left: 70px; right: 0;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input-wrapper{border: 1px solid #cccccc; background-color: #ffffff;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input{border: none; padding-left: 32px; padding-right: 30px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input{padding-left: 30px; padding-right: 32px;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input:focus{box-shadow: none;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn{left: 10px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn{right: 10px; left: auto;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn:hover{cursor: auto; background-position: 0 -291px;}.jimu-widget-layerList .layer-filter .search-input-node.invalid{display: none;}.jimu-widget-layerList .layer-filter .search-button{width: 20px; height: 20px; position: absolute; top: -2px; right: 23px; background-image: url("../images/search_normal.svg"); background-repeat: no-repeat; background-position: center; cursor: pointer;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-button{left: 23px; right: auto;}.jimu-widget-layerList .layer-filter .search-button:hover{background-image: url("../images/search_hover.svg");}.jimu-widget-layerList .layer-filter .search-button.invalid{display: none;}.jimu-widget-layerList .layer-filter .cancel-button{width: 69px; height: 30px; line-height: 30px; border: 1px solid #cccccc; position: absolute; top: -5px; right: 0; z-index: 1; background-color: #ffffff; text-align: center; cursor: pointer; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 2px 0 2px;}.jimu-rtl .jimu-widget-layerList .layer-filter .cancel-button{left: 0; right: auto;}.jimu-widget-layerList .layer-filter .cancel-button.invalid{display: none;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button{width: 15px; height: 25px; position: absolute; top: 7px; right: 10px; z-index: 1; background-image: url("../images/clear.svg"); background-repeat: no-repeat; background-position: center; background-size: 10px 10px;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button.disable{display: none;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button:hover{background-image: url("../images/clear_hover.svg");}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .clear-input-button{left: 10px; right: auto;}',
"*now":function(p){p(['dojo/i18n!*preload*widgets/LayerList/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("jimu/BaseWidget dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom dojo/on dojo/query dijit/registry ./LayerListView ./LayerFilter ./NlsStrings jimu/LayerInfos/LayerInfos".split(" "),function(p,n,f,h,k,d,e,q,m,c,a,l,v){return n([p],{baseClass:"jimu-widget-layerList",name:"layerList",layerFilter:null,_denyLayerInfosReorderResponseOneTime:null,_denyLayerInfosIsVisibleChangedResponseOneTime:null,layerListView:null,operLayerInfos:null,postCreate:function(){!1===this.config.showTitle&&
(this.layerListTitle.innerHTML="",k.addClass(this.layerListTitle,"disable"))},startup:function(){this.inherited(arguments);this._createLayerFilter();l.value=this.nls;this._denyLayerInfosIsVisibleChangedResponseOneTime=this._denyLayerInfosReorderResponseOneTime=!1;if(this.map.itemId)v.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,function(a){this.operLayerInfos=a;this.showLayers();this.bindEvents();d.setSelectable(this.layerListBody,!1);d.setSelectable(this.layerListTitle,!1)}));else{var a=
this._obtainMapLayers();v.getInstance(this.map,a).then(f.hitch(this,function(a){this.operLayerInfos=a;this.showLayers();this.bindEvents();d.setSelectable(this.layerListBody,!1);d.setSelectable(this.layerListTitle,!1)}))}},_createLayerFilter:function(){this.layerFilter=(new a({layerListWidget:this})).placeAt(this.layerFilterNode)},destroy:function(){this._clearLayers();this.inherited(arguments)},_obtainMapLayers:function(){var a=[],c=[],d={itemData:{baseMap:{baseMapLayers:[]},operationalLayers:[]}};
h.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);a.isOperationalLayer&&c.push({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" "})},this);h.forEach(this.map.layerIds,function(b){b=this.map.getLayer(b);b.isOperationalLayer?c.push({layerObject:b,title:b.label||b.title||b.name||b.id||" ",id:b.id||" "}):a.push({layerObject:b,id:b.id||" "})},this);d.itemData.baseMap.baseMapLayers=a;d.itemData.operationalLayers=c;return d},showLayers:function(){this.layerListView=
(new c({operLayerInfos:this.operLayerInfos,layerListWidget:this,layerFilter:this.layerFilter,config:this.config})).placeAt(this.layerListBody);this.config.expandAllLayersByDefault&&this.layerListView.foldOrUnfoldAllLayers(!1)},_clearLayers:function(){this.layerListView&&this.layerListView.destroyRecursive&&this.layerListView.destroyRecursive()},_refresh:function(){this._clearLayers();this.showLayers()},bindEvents:function(){this.own(e(this.operLayerInfos,"layerInfosChanged",f.hitch(this,this._onLayerInfosChanged)));
this.config.showBasemap&&this.own(e(this.operLayerInfos,"basemapLayerInfosChanged",f.hitch(this,this._onLayerInfosChanged)));this.own(e(this.operLayerInfos,"tableInfosChanged",f.hitch(this,this._onTableInfosChanged)));this.own(this.operLayerInfos.on("layerInfosIsVisibleChanged",f.hitch(this,this._onLayerInfosIsVisibleChanged)));this.own(e(this.operLayerInfos,"layerInfosReorder",f.hitch(this,this._onLayerInfosReorder)));this.own(e(this.map,"zoom-end",f.hitch(this,this._onZoomEnd)));this.own(e(this.operLayerInfos,
"layerInfosRendererChanged",f.hitch(this,this._onLayerInfosRendererChanged)));this.own(e(this.operLayerInfos,"layerInfosOpacityChanged",f.hitch(this,this._onLayerInfosOpacityChanged)));this.own(e(this.operLayerInfos,"layerInfosScaleRangeChanged",f.hitch(this,this._onLayerInfosScaleRangeChanged)))},_onLayerInfosChanged:function(){this.layerFilter.cancelFilter();this.layerListView.refresh()},_onTableInfosChanged:function(){this.layerFilter.cancelFilter();this.layerListView.refresh()},_onLayerInfosIsVisibleChanged:function(a){this._denyLayerInfosIsVisibleChangedResponseOneTime?
this._denyLayerInfosIsVisibleChangedResponseOneTime=!1:h.forEach(a,function(a){q("[class~\x3d'visible-checkbox-"+a.id+"']",this.domNode).forEach(function(c){c=m.byNode(c);a.isVisible()?c.check():c.uncheck()},this)},this)},_onZoomEnd:function(){var a=[];this.operLayerInfos.traversal(f.hitch(this,function(c){a.push(c)}));var c=this;setTimeout(function(){var d=a.shift();q("[class~\x3d'layer-title-div-"+d.id+"']",this.domNode).forEach(function(a){try{d.isInScale()?k.removeClass(a,"grayed-title"):k.addClass(a,
"grayed-title")}catch(u){console.warn(u.message)}},c);0<a.length&&setTimeout(arguments.callee,30)},30)},_onLayerInfosReorder:function(){this._denyLayerInfosReorderResponseOneTime?this._denyLayerInfosReorderResponseOneTime=!1:this._refresh()},_onLayerInfosRendererChanged:function(a){try{h.forEach(a,function(a){this.layerListView.redrawLegends(a)},this)}catch(t){this._refresh()}},_onLayerInfosOpacityChanged:function(a){h.forEach(a,function(a){var c=void 0===a.layerObject.opacity?1:a.layerObject.opacity;
a=q("[layercontenttrnodeid\x3d'"+a.id+"']",this.domNode)[0];q(".legends-div.jimu-legends-div-flag img",a).style("opacity",c)},this)},_onLayerInfosScaleRangeChanged:function(a){h.forEach(a,function(a){var c=[];a.traversal(f.hitch(this,function(a){c.push(a)}));var b=this,d=0;setTimeout(function(){var a=c.slice(d,d+10);d+=10;h.forEach(a,function(a){q("[class~\x3d'layer-title-div-"+a.id+"']",this.domNode).forEach(function(b){try{a.isInScale()?k.removeClass(b,"grayed-title"):k.addClass(b,"grayed-title")}catch(y){console.warn(y.message)}},
b)});c.length>d&&setTimeout(arguments.callee,30)},30)},this)},onAppConfigChanged:function(a,c,d){this.appConfig=a}})});