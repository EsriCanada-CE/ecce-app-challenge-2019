// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/SmartEditor/setting/CopyAttributes.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"settingsDesc" data-dojo-attach-point\x3d"validationDesc"\x3e${nls.actionPage.description}\x3c/div\x3e\r\n\x3cdiv data-dojo-attach-point\x3d"copyAttributeTable"\x3e\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/Evented dojo/query dojo/dom-style dojo/_base/lang dojo/_base/array dojo/on dojo/text!./CopyAttributes.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/Popup esri/lang ./Intersection ./Coordinates ./Address".split(" "),function(g,h,k,l,d,e,m,n,p,q,r,t,u,v,w,x){return g([q,h,p],{baseClass:"jimu-widget-smartEditor-rule-table",templateString:n,_resourceInfo:null,_url:null,_fieldName:null,_fieldValues:null,_configuredFieldValues:null,_layerId:null,
_validGeocoderFields:[],ValidFieldsForCoordinates:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"],ValidFieldsByType:{esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeInteger:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeSmallInteger","esriFieldTypeInteger",
"esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeSingle:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeGUID:["esriFieldTypeGUID"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:"esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeGUID esriFieldTypeDate".split(" ")},postCreate:function(){this.inherited(arguments);this._configuredFieldValues=[];this._initActionsTable();
this._setActionsTable()},getSettings:function(){return this._fieldValues},_getConfigActionOrder:function(){var b=[],a=[];this.isRelatedLayer?a=["Preset"]:(a=["Intersection"],this._validGeocoderFields=this._getValidGeocoderFields(),this._validGeocoderFields.length&&a.push("Address"),-1<this.ValidFieldsForCoordinates.indexOf(this._fieldType)&&a.push("Coordinates"),a.push("Preset"));return void 0!==this._fieldValues&&null!==this._fieldValues&&this._fieldValues.hasOwnProperty(this._fieldName)&&(e.forEach(this._fieldValues[this._fieldName],
function(f){-1<a.indexOf(f.actionName)&&b.push(f.actionName)}),null!==b&&0!==b.length)?b:a},_getValidGeocoderFields:function(){var b=[],a=[],b=this.ValidFieldsByType[this._fieldType];this._geocoderSettings&&this._geocoderSettings.hasOwnProperty("url")&&(a=e.filter(this._geocoderSettings.fields,function(a){return-1<b.indexOf(a.type)?!0:!1}));return a},_getConfigAction:function(b){var a=null;void 0!==this._fieldValues&&null!==this._fieldValues&&this._fieldValues.hasOwnProperty(this._fieldName)&&e.some(this._fieldValues[this._fieldName],
function(f){return f.actionName===b?(a=f,!0):!1});return a},_nlsActionToConfig:function(b){switch(b){case this.nls.actionPage.copyAction.intersection:return"Intersection";case this.nls.actionPage.copyAction.address:return"Address";case this.nls.actionPage.copyAction.coordinates:return"Coordinates";case this.nls.actionPage.copyAction.preset:return"Preset";default:return b}},popupActionsPage:function(){var b=new t({titleLabel:u.substitute({fieldname:this._fieldName},this.nls.actionPage.title),width:920,
maxHeight:600,autoHeight:!0,content:this,buttons:[{label:this.nls.ok,onClick:d.hitch(this,function(){var a=this._copyAttrTable.getRows();if(void 0===this._fieldValues||null===this._fieldValues)this._fieldValues={};this._fieldValues[this._fieldName]=[];e.forEach(a,function(a){a=this._copyAttrTable.getRowData(a);var b={};b.actionName=this._nlsActionToConfig(a.actionName);this._configuredFieldValues[b.actionName]?d.mixin(b,this._configuredFieldValues[b.actionName]):d.mixin(b,{enabled:!1});d.mixin(b,
{enabled:a.enabled});"Preset"===b.actionName&&this._configuredPresetInfos&&!this._configuredPresetInfos.hasOwnProperty(this._fieldName)&&(this._configuredPresetInfos[this._fieldName]=[""]);this._fieldValues[this._fieldName].push(b)},this);b.close()})},{label:this.nls.cancel,classNames:["jimu-btn jimu-btn-vacation"],onClick:d.hitch(this,function(){b.close()})}],onClose:d.hitch(this,function(){})})},_initActionsTable:function(){this._copyAttrTable=new r({fields:[{name:"enabled",title:this.nls.actionPage.copyAction.enableText,
type:"checkbox",width:"15%"},{name:"actionName",title:this.nls.actionPage.copyAction.actionText,type:"text"},{name:"actions",title:this.nls.actionPage.copyAction.criteriaText,type:"actions",actions:["up","down","edit"],"class":"actions"}],selectable:!1,style:{height:"300px",maxHeight:"300px"}});this._copyAttrTable.placeAt(this.copyAttributeTable);this._copyAttrTable.startup();this.own(m(this._copyAttrTable,"actions-edit",d.hitch(this,this._onEditFieldInfoClick)))},_onEditFieldInfoClick:function(b){switch(this._copyAttrTable.getRowData(b).actionName){case this.nls.actionPage.copyAction.intersection:this._createIntersectionPanel();
break;case this.nls.actionPage.copyAction.address:this._geocoderSettings&&this._geocoderSettings.hasOwnProperty("url")?this._createAddressPanel():this.emit("SetGeocoder");break;case this.nls.actionPage.copyAction.coordinates:this._createCoordinatesPanel()}},_createIntersectionPanel:function(){this._intersectionDijit=v({nls:this.nls,_fieldValues:this._configuredFieldValues,layerInfos:this.layerInfos,map:this.map,_fieldType:this._fieldType,ValidFieldsByType:this.ValidFieldsByType})},_createCoordinatesPanel:function(){this._coordinatesDijit=
w({nls:this.nls,_fieldValues:this._configuredFieldValues})},_createAddressPanel:function(){this._addressDijit=x({nls:this.nls,_fieldValues:this._configuredFieldValues,_geocoderSettings:this._geocoderSettings,_validGeocoderFields:this._validGeocoderFields})},_setActionsTable:function(){var b=this._getConfigActionOrder();e.forEach(b,function(a){var b=this._getConfigAction(a),c=a;switch(a){case "Intersection":this.nls.actionPage.hasOwnProperty("copyAction")&&this.nls.actionPage.copyAction.hasOwnProperty("intersection")&&
(c=this.nls.actionPage.copyAction.intersection);break;case "Address":this.nls.actionPage.hasOwnProperty("copyAction")&&this.nls.actionPage.copyAction.hasOwnProperty("address")&&(c=this.nls.actionPage.copyAction.address);break;case "Coordinates":this.nls.actionPage.hasOwnProperty("copyAction")&&this.nls.actionPage.copyAction.hasOwnProperty("coordinates")&&(c=this.nls.actionPage.copyAction.coordinates);break;case "Preset":this.nls.actionPage.hasOwnProperty("copyAction")&&this.nls.actionPage.copyAction.hasOwnProperty("preset")&&
(c=this.nls.actionPage.copyAction.preset);break;default:c=a}c={actionName:c};void 0!==b&&null!==b?this._configuredFieldValues[a]=b:(this._configuredFieldValues[a]={enabled:!1},"Intersection"===a&&(this._configuredFieldValues[a].fields=[]),"Coordinates"===a&&(this._configuredFieldValues[a].coordinatesSystem="MapSpatialReference",this._configuredFieldValues[a].field="x"));c.enabled=this._configuredFieldValues[a].enabled;b=this._copyAttrTable.addRow(c);"Preset"===a&&(a=k(".jimu-icon-edit",b.tr))&&0<
a.length&&l.set(a[0],"display","none")},this)},geocoderConfigured:function(){this._geocoderSettings&&this._geocoderSettings.hasOwnProperty("url")&&this._createAddressPanel()}})});