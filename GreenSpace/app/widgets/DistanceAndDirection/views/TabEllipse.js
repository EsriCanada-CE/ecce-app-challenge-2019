// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/DistanceAndDirection/templates/TabEllipse.html":'\x3cdiv class\x3d"tabPanel" data-dojo-attach-point\x3d"ellipseContainer"\x3e\r\n  \x3cdiv class\x3d"controls"\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel\x3e${nls.ellipseTypeLabel}\x3c/label\x3e\r\n      \x3cdiv class\x3d"controlItem"\x3e\r\n        \x3cselect style\x3d"width: 225px" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"ellipseType"\x3e\r\n          \x3coption value\x3d"semi"\x3e${nls.ellipseSemiLabel}\x3c/option\x3e\r\n          \x3coption value\x3d"full"\x3e${nls.ellipseFullLabel}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel data-dojo-attach-point\x3d"coordInputLabel"\x3e${nls.centerPointLabel}\x3c/label\x3e\r\n      \x3cdiv class\x3d"controlItem"\x3e\r\n        \x3cinput class\x3d"jimu-input coordInput" data-dojo-attach-point\x3d"startPointCoords" placeholder\x3d"${nls.startPointPlaceHolderLabel}"\r\n        /\x3e\r\n        \x3cdiv class\x3d"controlItem paddedLeft"\x3e\r\n          \x3cdiv class\x3d\'add-with-icon\'\x3e\r\n            \x3cspan title\x3d"${nls.formatInputLabel}" class\x3d"jimu-icon settingBtn safariOnly" data-dojo-attach-point\x3d"coordinateFormatButton"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d\'add-with-icon\'\x3e\r\n            \x3cdiv title\x3d"${nls.drawEllipseLabel}" class\x3d"drawPointBtn" data-dojo-attach-point\x3d"addPointBtn"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"controlGroup"\x3e\r\n        \x3cinput class\x3d"interactive-checkbox" type\x3d"checkbox" data-dojo-attach-point\x3d"interactiveEllipse" /\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"interactiveLabel"\x3e${nls.createEllipseInteractively}\x3c/label\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cfieldset\x3e\r\n      \x3clegend\x3e${nls.axisLabel}\x3c/legend\x3e\r\n      \x3cdiv class\x3d"controlGroup" data-dojo-attach-point\x3d"majorAxisInputDiv"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"majorAxisLabel"\x3e${nls.majorRadiusLabel}\x3c/label\x3e\r\n        \x3cdiv class\x3d"controlItem"\x3e\r\n          \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" required\x3d\'true\' , value\x3d\'100\' , data-dojo-props\x3d"constraints:{min:1}" data-dojo-attach-point\x3d"majorAxisInput"\r\n          /\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"controlGroup" data-dojo-attach-point\x3d"minorAxisInputDiv"\x3e\r\n        \x3clabel data-dojo-attach-point\x3d"minorAxisLabel"\x3e${nls.minorRadiusLabel}\x3c/label\x3e\r\n        \x3cdiv class\x3d"controlItem"\x3e\r\n          \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" required\x3d\'true\' , value\x3d\'50\' , data-dojo-props\x3d"constraints:{min:1}" data-dojo-attach-point\x3d"minorAxisInput"\r\n          /\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"controlGroup"\x3e\r\n        \x3clabel\x3e${nls.unitLabel}\x3c/label\x3e\r\n        \x3cdiv class\x3d"controlItem"\x3e\r\n          \x3cselect style\x3d"width: 183px" data-dojo-type\x3d"dijit/form/Select" id\x3d"lengthUnitDD" data-dojo-attach-point\x3d"lengthUnitDD"\x3e\r\n            \x3coption value\x3d"feet"\x3e${nls.units.feet}\x3c/option\x3e\r\n            \x3coption value\x3d"kilometers" selected\x3d"selected"\x3e${nls.units.kilometers}\x3c/option\x3e\r\n            \x3coption value\x3d"miles"\x3e${nls.units.miles}\x3c/option\x3e\r\n            \x3coption value\x3d"meters"\x3e${nls.units.meters}\x3c/option\x3e\r\n            \x3coption value\x3d"nautical-miles"\x3e${nls.units.nauticalMiles}\x3c/option\x3e\r\n            \x3coption value\x3d"yards"\x3e${nls.units.yards}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3clabel\x3e${nls.orientationLabel}\x3c/label\x3e\r\n      \x3cdiv class\x3d"controlItem" data-dojo-attach-point\x3d"angleInputDiv"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" style\x3d"width: 150px" required\x3d\'true\' , value\x3d\'0\' , data-dojo-props\x3d"constraints:{min:0, max:360}"\r\n          data-dojo-attach-point\x3d"angleInput" /\x3e\r\n        \x3cselect style\x3d"width: 100px" class\x3d"controlSpace" data-dojo-type\x3d"dijit/form/Select" id\x3d"angleUnitDD" data-dojo-attach-point\x3d"angleUnitDD"\x3e\r\n          \x3coption value\x3d"degrees"\x3e${nls.degreesLabel}\x3c/option\x3e\r\n          \x3coption value\x3d"mils"\x3e${nls.milsLabel}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"controlGroup"\x3e\r\n      \x3cl abel class\x3d"warning"\x3e${nls.warningMessage}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"buttonContainer"\x3e\r\n      \x3cdiv class\x3d\'jimu-btn jimu-state-disabled\' data-dojo-attach-point\x3d\'okButton\' data-dojo-attach-event\x3d"onclick: okButtonClicked"\x3e${nls.common.ok}\x3c/div\x3e\r\n      \x3cdiv class\x3d\'jimu-btn\' data-dojo-attach-point\x3d\'clearGraphicsButton\'\x3e${nls.clearGraphicsLabel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/on dojo/topic dojo/dom-attr dojo/dom-class dojo/string dojo/number dojo/mouse dojo/keys dijit/_WidgetBase dijit/_TemplatedMixin dijit/TooltipDialog dijit/_WidgetsInTemplateMixin dijit/popup jimu/dijit/Message jimu/LayerInfos/LayerInfos jimu/utils esri/layers/GraphicsLayer esri/layers/FeatureLayer esri/layers/LabelClass esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleFillSymbol esri/symbols/TextSymbol esri/graphic esri/tasks/FeatureSet ../models/EllipseFeedback ../views/CoordinateInput ../views/EditOutputCoordinate dojo/text!../templates/TabEllipse.html dijit/form/NumberTextBox dijit/form/Select jimu/dijit/CheckBox".split(" "),
function(r,c,m,d,e,g,f,v,n,p,w,x,y,z,A,k,B,t,C,D,E,q,u,F,G,h,H,l,I,J,K){return r([x,y,A],{templateString:K,baseClass:"jimu-widget-TabEllipse",centerPointGraphic:null,constructor:function(b){r.safeMixin(this,b)},postCreate:function(){this.currentAngleUnit=this.angleUnitDD.get("value");this.currentLengthUnit=this.lengthUnitDD.get("value");this._labelSym=new G(this.labelSymbol);this._ptSym=new u(this.pointSymbol);this._ellipseSym=new F(this.ellipseSymbol);this._textGL=new D;this.map.addLayer(this._textGL);
this.map.addLayer(this.getLayer());if(this._gl.loaded){var b=t.getInstanceSync().getLayerInfoById("Distance \x26 Direction - Ellipse Graphics");b.showLabels();b.enablePopup()}else this._gl.on("load",c.hitch(this,function(){var a=t.getInstanceSync().getLayerInfoById("Distance \x26 Direction - Ellipse Graphics");a.showLabels();a.enablePopup()}));this.coordTool=new I({appConfig:this.appConfig,nls:this.nls},this.startPointCoords);this.coordTool.inputCoordinate.formatType="DD";this.coordinateFormat=new z({content:new J({nls:this.nls}),
style:"width: 400px"});"DartTheme"===this.appConfig.theme.name&&f.add(this.coordinateFormat.domNode,"dartThemeClaroDijitTooltipContainerOverride");this.dt=new l({map:this.map,coordTool:this.coordTool.inputCoordinate.util,nls:this.nls});this.dt.setLineSymbol(this._ellipseSym);this.dt.set("lengthUnit","kilometers");this.dt.set("angle",0);this.dt.set("ellipseType","semi");this.syncEvents();this.checkValidInputs();this.majorAxisInput.invalidMessage=this.nls.numericInvalidMessage;this.majorAxisInput.rangeMessage=
this.nls.axisErrorMessage;this.minorAxisInput.invalidMessage=this.nls.numericInvalidMessage;this.minorAxisInput.rangeMessage=this.nls.axisErrorMessage;this.angleInput.invalidMessage=this.nls.numericInvalidMessage;this.angleInput.rangeMessage=this.nls.orientationErrorMessage},getLayer:function(){if(!this._gl){var b=[],a={labelExpressionInfo:{value:this.nls.ellipseMajorAxis+" {MAJOR}"}},a=new q(a);a.labelPlacement="above-along";a.symbol=c.clone(this._labelSym).setOffset(0,20);b.push(a);a={labelExpressionInfo:{value:this.nls.ellipseMinorAxis+
" {MINOR}"}};a=new q(a);a.labelPlacement="center-along";a.symbol=this._labelSym;b.push(a);a={labelExpressionInfo:{value:this.nls.angleLabel+": {ORIENTATION_ANGLE}"}};a=new q(a);a.labelPlacement="below-along";a.symbol=c.clone(this._labelSym).setOffset(0,-20);b.push(a);b={layerDefinition:{extent:{xmin:0,ymin:0,xmax:0,ymax:0,spatialReference:{wkid:102100,latestWkid:102100}},geometryType:"esriGeometryPolygon",objectIdField:"ObjectID",fields:[{name:"ObjectID",alias:"ObjectID",type:"esriFieldTypeOID"},
{name:"MAJOR",type:"esriFieldTypeText",alias:"Major Axis"},{name:"MINOR",type:"esriFieldTypeText",alias:"Minor Axis"},{name:"ORIENTATION_ANGLE",type:"esriFieldTypeText",alias:"Orientation Angle"}]},featureSet:new H};this._gl=new E(b,{id:"Distance \x26 Direction - Ellipse Graphics",showLabels:!0});this.own(d(this._gl,"visibility-change",c.hitch(this,function(a){this._textGL.setVisibility(a.visible)})));return this._gl}},syncEvents:function(){e.subscribe("TAB_SWITCHED",c.hitch(this,this.tabSwitched));
e.subscribe("DD-WIDGET-CLOSED",c.hitch(this,this._closeDijit));e.subscribe(l.DD_ELLIPSE_MINOR_LENGTH_CHANGE,c.hitch(this,this.minorLengthDidChange));e.subscribe(l.DD_ELLIPSE_MAJOR_LENGTH_CHANGE,c.hitch(this,this.majorLengthDidChange));e.subscribe(l.DD_ELLIPSE_ANGLE_CHANGE,c.hitch(this,this.angleDidChange));this.dt.watch("startPoint",c.hitch(this,function(b,a,c){this.coordTool.inputCoordinate.set("coordinateEsriGeometry",c);this.dt.addStartGraphic(c,this._ptSym)}));this.coordTool.inputCoordinate.watch("outputString",
c.hitch(this,function(b,a,c){this.coordTool.manualInput||this.coordTool.set("value",c)}));this.own(this.dt.on("draw-complete",c.hitch(this,this.feedbackDidComplete)),this.ellipseType.on("change",c.hitch(this,this.ellipseTypeDDDidChange)),this.angleUnitDD.on("change",c.hitch(this,this.angleUnitDDDidChange)),this.lengthUnitDD.on("change",c.hitch(this,this.lengthUnitDDDidChange)),d(this.coordinateFormatButton,"click",c.hitch(this,this.coordinateFormatButtonWasClicked)),d(this.coordinateFormat.content.applyButton,
"click",c.hitch(this,function(){var b=this.coordinateFormat.content.formats[this.coordinateFormat.content.ct],a=b.defaultFormat,c=this.coordinateFormat.content.frmtSelect.get("value");b.useCustom&&(a=b.customFormat);this.coordTool.inputCoordinate.set("formatPrefix",this.coordinateFormat.content.addSignChkBox.checked);this.coordTool.inputCoordinate.set("formatString",a);this.coordTool.inputCoordinate.set("formatType",c);this.setCoordLabel(c);k.close(this.coordinateFormat)})),d(this.addPointBtn,"click",
c.hitch(this,this.pointButtonWasClicked)),d(this.interactiveEllipse,"change",c.hitch(this,this.interactiveCheckBoxChanged)),d(this.coordTool,"keyup",c.hitch(this,this.coordToolKeyWasPressed)),d(this.angleInput,"change",c.hitch(this,this.angleDidChange)),d(this.coordinateFormat.content.cancelButton,"click",c.hitch(this,function(){k.close(this.coordinateFormat)})),d(this.clearGraphicsButton,"click",c.hitch(this,this.clearGraphics)),d(this.majorAxisInputDiv,p.leave,c.hitch(this,this.checkValidInputs)),
d(this.minorAxisInputDiv,p.leave,c.hitch(this,this.checkValidInputs)),d(this.angleInputDiv,p.leave,c.hitch(this,this.checkValidInputs)))},okButtonClicked:function(){f.contains(this.okButton,"jimu-state-disabled")||("full"===g.get(this.ellipseType,"value")?e.publish("create-manual-ellipse",this.majorAxisInput.get("value")/2,this.minorAxisInput.get("value")/2,this.angleInput.get("value"),this.coordTool.inputCoordinate.coordinateEsriGeometry):e.publish("create-manual-ellipse",this.majorAxisInput.get("value"),
this.minorAxisInput.get("value"),this.angleInput.get("value"),this.coordTool.inputCoordinate.coordinateEsriGeometry))},majorLengthDidChange:function(b){"full"===g.get(this.ellipseType,"value")&&(b*=2);var a=n.format(b,{places:2,locale:m.locale});this.majorAxisInput.set("value",b);this.majorAxisInput.set("displayedValue",a)},minorLengthDidChange:function(b){"full"===g.get(this.ellipseType,"value")&&(b*=2);var a=n.format(b,{places:2,locale:m.locale});this.minorAxisInput.set("value",b);this.minorAxisInput.set("displayedValue",
a)},angleDidChange:function(b){var a=n.format(b,{places:2,locale:m.locale});this.angleInput.set("value",b);this.angleInput.set("displayedValue",a);this.dt.set("angle",b)},interactiveCheckBoxChanged:function(){this.tabSwitched();this.interactiveEllipse.checked?(this.majorAxisInput.set("disabled",!0),this.minorAxisInput.set("disabled",!0),this.angleInput.set("disabled",!0)):(this.majorAxisInput.set("disabled",!1),this.minorAxisInput.set("disabled",!1),this.angleInput.set("disabled",!1));this.checkValidInputs()},
coordToolKeyWasPressed:function(b){this.dt.removeStartGraphic();b.keyCode===w.ENTER&&this.coordTool.inputCoordinate.getInputType().then(c.hitch(this,function(a){"UNKNOWN"===a.inputType?(new B({message:this.nls.invalidCoordinateTypeMessage}),this.coordTool.inputCoordinate.coordinateEsriGeometry=null):(e.publish("manual-ellipse-center-point-input",this.coordTool.inputCoordinate.coordinateEsriGeometry),this.setCoordLabel(a.inputType),this.coordTool.inputCoordinate.set("formatString",this.coordinateFormat.content.formats[a.inputType].defaultFormat),
this.coordTool.inputCoordinate.set("formatType",a.inputType),this.dt.addStartGraphic(a.coordinateEsriGeometry,this._ptSym));this.checkValidInputs()}))},coordinateFormatButtonWasClicked:function(){this.coordinateFormat.content.set("ct",this.coordTool.inputCoordinate.formatType);k.open({popup:this.coordinateFormat,around:this.coordinateFormatButton})},_closeDijit:function(){this.coordinateFormat&&this.coordinateFormat.domNode.offsetParent&&k.close(this.coordinateFormat)},pointButtonWasClicked:function(){f.contains(this.addPointBtn,
"drawPointBtn-active")?(this.dt.deactivate(),this.map.enableMapNavigation()):(this.coordTool.manualInput=!1,e.publish("clear-points"),this.map.disableMapNavigation(),this.interactiveEllipse.checked?this.dt.activate("polyline"):this.dt.activate("point"));f.toggle(this.addPointBtn,"drawPointBtn-active")},lengthUnitDDDidChange:function(){this.currentLengthUnit=this.lengthUnitDD.get("value");this.dt.set("lengthUnit",this.currentLengthUnit)},ellipseTypeDDDidChange:function(){this.majorAxisLabel.textContent=
"full"===g.get(this.ellipseType,"value")?this.nls.majorDiameterLabel:this.nls.majorRadiusLabel;this.minorAxisLabel.textContent="full"===g.get(this.ellipseType,"value")?this.nls.minorDiameterLabel:this.nls.minorRadiusLabel},angleUnitDDDidChange:function(){this.currentAngleUnit=this.angleUnitDD.get("value");this.dt.set("angleUnit",this.currentAngleUnit);"degrees"===this.currentAngleUnit?(this.angleInput.constraints.max=360,this.angleInput.rangeMessage=this.nls.degreesRangeMessage):(this.angleInput.constraints.max=
6400,this.angleInput.rangeMessage=this.nls.millsRangeMessage)},feedbackDidComplete:function(b){if("polygon"===b.geometry.type){var a=new h(b.geometry.geometry,this._ellipseSym),d=this.majorAxisLabel.textContent.split(" ")[1];a.setAttributes({MINOR:d+": "+this.minorAxisInput.get("displayedValue")+" "+this.lengthUnitDD.get("displayedValue"),MAJOR:d+": "+this.majorAxisInput.get("displayedValue")+" "+dijit.byId("lengthUnitDD").get("displayedValue"),ORIENTATION_ANGLE:this.angleInput.get("displayedValue")+
" "+this.angleUnitDD.get("displayedValue")});this._gl.add(a);b=b.geometry.geometry.getCentroid();a=window.isRTL?this.minorAxisInput.get("displayedValue")+" "+this._getLengthAbbrevation(this.lengthUnitDD.get("value"))+" "+this.nls.minorRadiusLabel:this.minorAxisLabel.textContent+" "+this.minorAxisInput.get("displayedValue")+" "+this._getLengthAbbrevation(this.lengthUnitDD.get("value"));this._textGL.add(new h(b,c.clone(this._labelSym).setOffset(0,20).setText(a)));a=window.isRTL?this.majorAxisInput.get("displayedValue")+
" "+this._getLengthAbbrevation(dijit.byId("lengthUnitDD").get("value"))+" "+this.nls.majorRadiusLabel:this.majorAxisLabel.textContent+" "+this.majorAxisInput.get("displayedValue")+" "+this._getLengthAbbrevation(dijit.byId("lengthUnitDD").get("value"));this._textGL.add(new h(b,c.clone(this._labelSym).setText(a)));a=window.isRTL?this.angleInput.get("displayedValue")+" "+this._getDegreeAbbreviation(this.angleUnitDD.get("value"))+" "+this.nls.angleLabel:this.nls.angleLabel+" "+this.angleInput.get("displayedValue")+
" "+this._getDegreeAbbreviation(this.angleUnitDD.get("value"));this._textGL.add(new h(b,c.clone(this._labelSym).setOffset(0,-20).setText(a)));this._gl.refresh()}else this.checkValidInputs();this.map.enableMapNavigation();this.dt.deactivate();f.remove(this.addPointBtn,"drawPointBtn-active")},clearGraphics:function(){this._gl&&(this._gl.clear(),this.coordTool.clear(),this._textGL.clear());f.remove(this.addPointBtn,"drawPointBtn-active");this.checkValidInputs();for(var b=0;b<this.map.graphicsLayerIds.length;b++)this.map.getLayer(this.map.graphicsLayerIds[b]).refresh()},
setGraphicsHidden:function(){this._gl&&this._gl.hide()},setGraphicsShown:function(){this._gl&&this._gl.show()},createCenterPointGraphic:function(){null!==this.centerPointGraphic&&this._gl.remove(this.centerPointGraphic);var b=this.coordTool.inputCoordinate.coordinateEsriGeometry;b&&(this.centerPointGraphic=new h(b,new u),this._gl.add(this.centerPointGraphic))},removeCenterPointGraphic:function(){this.centerPointGraphic&&this._gl.remove(this.centerPointGraphic)},setCoordLabel:function(b){this.coordInputLabel.innerHTML=
C.sanitizeHTML(v.substitute(this.nls.centerPointLabel+" (${crdType})",{crdType:b}))},checkValidInputs:function(){f.add(this.okButton,"jimu-state-disabled");this.interactiveEllipse.checked||null!==this.coordTool.inputCoordinate.coordinateEsriGeometry&&this.majorAxisInput.isValid()&&this.minorAxisInput.isValid()&&this.angleInput.isValid()&&f.remove(this.okButton,"jimu-state-disabled")},tabSwitched:function(){this.dt.deactivate();this.dt.cleanup();this.dt.disconnectOnMouseMoveHandler();this.map.enableMapNavigation();
this.dt.removeStartGraphic();f.remove(this.addPointBtn,"drawPointBtn-active")},_getLengthAbbrevation:function(b){var a=null;if(b)switch(b){case "feet":a=this.nls.abbrevFeetLabel;break;case "kilometers":a=this.nls.abbrevKmLabel;break;case "miles":a=this.nls.abbrevMilesLabel;break;case "meters":a=this.nls.abbrevMetersLabel;break;case "nautical-miles":a=this.nls.abbrevNauticalMilesLabel;break;case "yards":a=this.nls.abbrevYardsLabel;break;default:a=b}return a},_getDegreeAbbreviation:function(b){var a=
null;if(b)switch(b){case "degrees":a=this.nls.abbrevDegreesLabel;break;case "mils":a=this.nls.abbrevMilsLabel;break;default:a=b}return a}})});