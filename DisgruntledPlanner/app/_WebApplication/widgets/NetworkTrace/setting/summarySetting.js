// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/NetworkTrace/setting/summarySetting.html":'\x3cdiv class\x3d"ParameterDiv"\x3e\r\n    \x3cdiv class\x3d"esriCTSummaryParentDiv"\x3e\r\n        \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n            \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.summaryTab.summaryFieldsetText}\x3c/legend\x3e\r\n\r\n            \x3cdiv class\x3d"esriCTMultiSelectParent"\x3e\r\n                \x3cdiv class\x3d"esriCTMultiSelectContainer esriCTInputOutputPanelParentContainer"\x3e\r\n                    \x3cdiv class\x3d"esriCTLblContainer esriCTInputOutputPanelLblContainer"\x3e\r\n                        ${nls.summaryTab.inputOutput}\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTInputPanel" data-dojo-attach-point\x3d"inputOutputParameterPanel"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTMultiSelectContainer" data-dojo-attach-point\x3d"fieldParentContainer"\x3e\r\n                    \x3cdiv class\x3d"esriCTLblContainer esriCTFieldPanelLblContainer"\x3e\r\n                        ${nls.summaryTab.field}\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTFieldPanel" data-dojo-attach-point\x3d"fieldPanel"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTMultiSelectContainer esriCTOperatorParentContainer" data-dojo-attach-point\x3d"operatorParentContainer"\x3e\r\n                    \x3cdiv class\x3d"esriCTLblContainer esriCTOperatorPanelLblContainer"\x3e\r\n                        ${nls.summaryTab.operator}\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTOperatorPanel" data-dojo-attach-point\x3d"operatorPanel"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTSummaryHintField"\x3e\r\n                ${nls.hintText.expressionHint}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTButtonContainer"\x3e\r\n                \x3cdiv style\x3d"float: left" title\x3d"${nls.summaryTab.expressionAddButtonText}" data-dojo-attach-event\x3d"onclick:_onClickAddExpressionBtn"\r\n                    data-dojo-attach-point\x3d"addSummaryExpression" class\x3d"jimu-state-disabled jimu-btn jimu-float-trailing esriSetButton jimu-leading-margin1"\x3e\r\n                    ${nls.summaryTab.expressionAddButtonText}\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"float: left;" title\x3d"${nls.summaryTab.expressionVerifyButtonText}" data-dojo-attach-event\x3d"onclick:_onClickVerifyExpressionBtn"\r\n                    data-dojo-attach-point\x3d"verifySummaryExpression" class\x3d"jimu-state-disabled jimu-btn jimu-float-trailing esriSetButton jimu-leading-margin1"\x3e\r\n                    ${nls.summaryTab.expressionVerifyButtonText}\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n        \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n            \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.summaryTab.summaryEditorText}\x3c/legend\x3e\r\n\r\n            \x3cdiv class\x3d"esriCTSummaryEditor"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"editorContainer"\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTSummaryHintField"\x3e\r\n                    ${nls.hintText.inputTextHint}\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare dojo/text!./summarySetting.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/dom-class dojo/dom-construct dojo/_base/lang dojo/on dojo/dom-attr dijit/Editor dojo/_base/html jimu/dijit/Message dijit/_editor/plugins/TextColor".split(" "),function(m,n,p,q,r,f,g,k,l,h,t,u,v){return m([p,q,r],{templateString:n,_selectedOutputParameter:null,_inputOutputSelect:null,_operatorSelect:null,_fieldSelect:null,_inputOutputParamArray:[],_selectedInput:null,
_selectedOutput:null,_selectedField:null,_selectedOperator:null,_summaryExpressionEditor:null,_editorObj:null,_outputLayerSettingsArr:[],_selectedOutputGeometryType:null,postCreate:function(){this._initEditor();this.inherited(arguments)},startup:function(){this.inherited(arguments)},_initEditor:function(){this._editorObj||(this._editorObj=new t({plugins:["bold","italic","underline","|","foreColor"]},this.editorContainer),u.setStyle(this._editorObj.domNode,{width:"100%",height:"100%"}),this.own(l(this._editorObj,
"focus",k.hitch(this,function(){f.remove(this.verifySummaryExpression,"jimu-state-disabled")}))),this.own(l(this._editorObj,"blur",k.hitch(this,function(){var a,b;a=this._editorObj.focusNode.innerHTML;a=a.replace(/&nbsp;/g,"");b=/<div><br><\/div>/g;a=a.replace(b,"");b=/<p><br><\/p>/g;a=a.replace(b,"");b=/<p><\/p>/g;a=a.replace(b,"");a=a.replace(/<br>/g,"");a=k.trim(a);null===a||""===a?(this._editorObj.set("value",""),f.add(this.verifySummaryExpression,"jimu-state-disabled")):f.remove(this.verifySummaryExpression,
"jimu-state-disabled")}))),this._editorObj.onLoadDeferred.then(k.hitch(this,function(){this._editorObj&&this._editorObj.hasOwnProperty("editNode")&&"title"in this._editorObj.editNode&&(null===this._editorObj.editNode.title||""===this._editorObj.editNode.title)&&(this._editorObj.editNode.title=this.nls.summaryTab.summaryEditorText)})),this._editorObj.startup())},displayInputOutputParameters:function(){g.empty(this.inputOutputParameterPanel);this._displayInputOutputPanelParameters();this._regainExistingConfigurationData()},
_regainExistingConfigurationData:function(){this.config.summaryExpression&&(this._editorObj.focus(),this._editorObj.set("value",this.config.summaryExpression.summaryExpressionValue),null===this.config.summaryExpression.summaryExpressionValue||""===this.config.summaryExpression.summaryExpressionValue?f.add(this.verifySummaryExpression,"jimu-state-disabled"):f.remove(this.verifySummaryExpression,"jimu-state-disabled"))},_displayInputOutputPanelParameters:function(){var a,b;this._inputOutputParamArray=
[];this._inputOutputSelect=g.create("select",{"class":"esriCTPanelSelect",size:2},this.inputOutputParameterPanel);for(b=0;b<this.inputParametersArray.length;b++)a=g.create("option",{}),a.innerHTML=this.inputParametersArray[b].name,a.value=this.inputParametersArray[b].name,a.title=this.inputParametersArray[b].name,h.set(a,"Type","Input"),this._inputOutputSelect.appendChild(a),f.add(a,"esriCTInputOutputOptions"),this._inputOutputParamArray.push(this.inputParametersArray[b]);for(b=0;b<this.outputParametersArray.length;b++)a=
g.create("option",{}),a.innerHTML=this.outputParametersArray[b].name,a.value=this.outputParametersArray[b].name,a.title=this.outputParametersArray[b].name,h.set(a,"Type","Output"),this.outputParametersArray[b]&&this.outputParametersArray[b].defaultValue&&this.outputParametersArray[b].defaultValue.geometryType?h.set(a,"GeometryType",this.outputParametersArray[b].defaultValue.geometryType):h.set(a,"GeometryType",null),this._inputOutputSelect.appendChild(a),f.add(a,"esriCTInputOutputOptions"),this._inputOutputParamArray.push(this.outputParametersArray[b]);
h.set(this._inputOutputSelect,"size",this._inputOutputParamArray.length);this._onInputOutputClick();this._insertBlankSelectInFieldPanel();this._insertBlankSelectInOperatorPanel();this._allocateEqualSizeToPanels()},_insertBlankSelectInFieldPanel:function(){var a;this._fieldSelect=g.create("select",{"class":"esriCTFieldPanelSelect",size:2},this.fieldPanel);a=g.create("option",{});a.innerHTML="";h.set(a,"disabled",!0);this._fieldSelect.appendChild(a);f.add(a,"esriCTBlankOptions")},_insertBlankSelectInOperatorPanel:function(){var a;
this._operatorSelect=g.create("select",{"class":"esriCTOperatorPanelSelect",size:2},this.operatorPanel);a=g.create("option",{});a.innerHTML="";h.set(a,"disabled",!0);this._operatorSelect.appendChild(a);f.add(a,"esriCTBlankOptions")},_emptyFieldPanel:function(){g.empty(this.fieldPanel);this._fieldSelect=null},_emptyOperatorPanel:function(){g.empty(this.operatorPanel);this._operatorSelect=null},_onInputOutputClick:function(){var a;this.own(l(this._inputOutputSelect,"click",k.hitch(this,function(b){a=
h.get(b.currentTarget[b.currentTarget.selectedIndex],"Type");"Input"===a?(f.add(this.addSummaryExpression,"jimu-state-disabled"),this._selectedInput=this._selectedOutput=this._selectedField=this._selectedOperator=null,this._selectedInput=b.currentTarget[b.currentTarget.selectedIndex],this._emptyFieldPanel(),this._emptyOperatorPanel(),this._insertBlankSelectInFieldPanel(),this._displayOperators(!0,!1,!1,!1),f.remove(this.operatorPanel,"esriCTHidden")):"Output"===a&&(this._selectedOutputGeometryType=
h.get(b.currentTarget[b.currentTarget.selectedIndex],"GeometryType"),this._selectedInput=this._selectedOutput=this._selectedField=this._selectedOperator=null,this._selectedOutput=b.currentTarget[b.currentTarget.selectedIndex],this._selectedOutputParameter=b,this._emptyFieldPanel(),this._emptyOperatorPanel(),this._displayOutputFields(),this._fetchAndDisplayOutputOperators())})))},_fetchAndDisplayOutputOperators:function(){f.add(this.addSummaryExpression,"jimu-state-disabled");this._displayOperators(!1,
!0,!1,!1);this._fieldSelect.selectedIndex="-1"},_displayOutputFields:function(){var a,b,c=[];g.empty(this.fieldPanel);c=this._inputOutputParamArray[this._selectedOutputParameter.currentTarget.selectedIndex].defaultValue.fields;this._fieldSelect=g.create("select",{"class":"esriCTFieldPanelSelect"},this.fieldPanel);for(b=0;b<c.length;b++)if("esriFieldTypeDouble"===c[b].type||"esriFieldTypeSmallInteger"===c[b].type||"esriFieldTypeInteger"===c[b].type)a=g.create("option",{}),a.innerHTML=c[b].name,a.value=
c[b].name,a.title=c[b].name,this._fieldSelect.appendChild(a),f.add(a,"esriCTInputOutputOptions");this._onFieldClick();this._allocateEqualSizeToPanels()},_onFieldClick:function(){this.own(l(this._fieldSelect,"click",k.hitch(this,function(a){f.add(this.addSummaryExpression,"jimu-state-disabled");this._selectedField=null;this._selectedField=a.currentTarget[a.currentTarget.selectedIndex];this._displayOperators(!1,!1,!0,!1);this._allocateEqualSizeToPanels()})))},_displayOperators:function(a,b,c,d){var e;
e=[];g.empty(this.operatorPanel);a?e.push(this.nls.summaryTab.inputOperatorCountOption):b?(e.push(this.nls.summaryTab.outputOperatorCountOption),d&&e.push(this.nls.summaryTab.outputOperatorSkipCountOption)):c&&(e.push(this.nls.summaryTab.fieldOperatorSumOption),e.push(this.nls.summaryTab.fieldOperatorMinOption),e.push(this.nls.summaryTab.fieldOperatorMaxOption),e.push(this.nls.summaryTab.fieldOperatorMeanOption));this._operatorSelect=g.create("select",{"class":"esriCTPanelSelect",size:2},this.operatorPanel);
for(b=0;b<e.length;b++)a=g.create("option",{}),a.innerHTML=e[b],a.value=e[b],a.title=e[b],this._operatorSelect.appendChild(a),f.add(a,"esriCTInputOutputOptions");this._selectOperator();this._allocateEqualSizeToPanels()},refreshOperator:function(){!this._selectedField&&this._selectedOutput&&(this._fetchAndDisplayOutputOperators(),this._selectedOperator&&this._selectedOperator.value===this.nls.summaryTab.outputOperatorCountOption&&this._operatorSelect&&(this._operatorSelect.selectedIndex=0,f.remove(this.addSummaryExpression,
"jimu-state-disabled")))},_selectOperator:function(){this.own(l(this._operatorSelect,"click",k.hitch(this,function(a){this._selectedOperator=null;this._selectedOperator=a.currentTarget[a.currentTarget.selectedIndex];null===this._selectedInput&&null===this._selectedOutput||null===this._selectedOperator||f.remove(this.addSummaryExpression,"jimu-state-disabled")})))},_allocateEqualSizeToPanels:function(){var a,b,c;c=b=a=0;this._inputOutputSelect&&0<this._inputOutputSelect.length&&(a=this._inputOutputSelect.length);
this._fieldSelect&&0<this._fieldSelect.length&&(b=this._fieldSelect.length);this._operatorSelect&&0<this._operatorSelect.length&&(c=this._operatorSelect.length);a=Math.max(a,b,c);this._inputOutputSelect&&h.set(this._inputOutputSelect,"size",a);this._fieldSelect&&h.set(this._fieldSelect,"size",a);this._operatorSelect&&h.set(this._operatorSelect,"size",a);this._removeClassFromChildNodes();this._inputOutputSelect&&this._inputOutputSelect.length===a&&f.add(this._inputOutputSelect.childNodes[a-1],"esriCTInputOutputOptionsBorderNone");
this._fieldSelect&&this._fieldSelect.length===a&&f.add(this._fieldSelect.childNodes[a-1],"esriCTInputOutputOptionsBorderNone");this._operatorSelect&&this._operatorSelect.length===a&&f.add(this._operatorSelect.childNodes[a-1],"esriCTInputOutputOptionsBorderNone")},_removeClassFromChildNodes:function(){var a;if(this._inputOutputSelect)for(a=0;a<this._inputOutputSelect.childNodes.length;a++)f.remove(this._inputOutputSelect.childNodes[a],"esriCTInputOutputOptionsBorderNone");if(this._fieldSelect)for(a=
0;a<this._fieldSelect.childNodes.length;a++)f.remove(this._fieldSelect.childNodes[a],"esriCTInputOutputOptionsBorderNone");if(this._operatorSelect)for(a=0;a<this._operatorSelect.childNodes.length;a++)f.remove(this._operatorSelect.childNodes[a],"esriCTInputOutputOptionsBorderNone")},_onClickAddExpressionBtn:function(){if(!f.contains(this.addSummaryExpression,"jimu-state-disabled")){var a=!1;null!==this._selectedInput&&null!==this._selectedOperator?(this._editorObj.focus(),this._editorObj.execCommand("inserthtml",
"{"+this._selectedInput.value+":"+this._selectedOperator.value+"}"),a=!0):null!==this._selectedOutput&&null===this._selectedField&&null!==this._selectedOperator?(this._editorObj.focus(),this._editorObj.execCommand("inserthtml","{"+this._selectedOutput.value+":"+this._selectedOperator.value+"}"),a=!0):null!==this._selectedOutput&&null!==this._selectedField&&null!==this._selectedOperator&&(this._editorObj.focus(),this._editorObj.execCommand("inserthtml","{"+this._selectedOutput.value+":"+this._selectedField.value+
":"+this._selectedOperator.value+"}"),a=!0);!0===a&&f.contains(this.verifySummaryExpression,"jimu-state-disabled")&&f.remove(this.verifySummaryExpression,"jimu-state-disabled")}},_onClickVerifyExpressionBtn:function(){f.contains(this.verifySummaryExpression,"jimu-state-disabled")||this.validateExpression(!0)},_errorMessage:function(a){(new v({message:a})).message=a},getSummaryExpressionConfigData:function(){var a;a={summaryExpressionValueArr:[]};a.summaryExpressionValue=this._editorObj.value;a.summaryExpressionValue.replace(/\{(.+?)\}/g,
function(b,c){b={};b.value=c;b.trimmedValue=c.replace(/\s/g,"");a.summaryExpressionValueArr.push(b)});a.summaryExpressionTrimmedValue=this._getSummaryExpressionFilteredValue(a.summaryExpressionValueArr);a.summaryExpressionNLS=this.nls.summaryTab;return a},_getSummaryExpressionFilteredValue:function(a){var b,c,d;c=this._editorObj.value;for(b=0;b<a.length;b++)d=new RegExp(a[b].value,"g"),c=c.replace(d,a[b].trimmedValue);return c},validateExpressionOnOkClick:function(){return this.validateExpression(!1)},
_validateExpressionEntry:function(a){var b,c,d,e;for(c=0;c<a.length;c++)for(d=a[c].split(":"),e=0;e<d.length;e++)if(0===e){if(b=this._validateInputOutputEntry(d[0]),!b)return!1}else if(1===e&&2===d.length){if(b=this._validateInputOutputOperatorEntry(d[0],d[1]),!b)return!1}else if(1===e&&3===d.length){if(b=this._validateFieldEntry(d[0],d[1]),!b)return!1}else if(2===e&&3===d.length&&(b=this._validateFieldOperatorEntry(d[2]),!b))return!1;return!0},_validateInputOutputEntry:function(a){var b,c;c=!1;for(b=
0;b<this.inputParametersArray.length;b++)a===this.inputParametersArray[b].name&&(c=!0);for(b=0;b<this.outputParametersArray.length;b++)a===this.outputParametersArray[b].name&&(c=!0);return c},_validateInputOutputOperatorEntry:function(a,b){var c,d;d=!1;this._outputLayerSettingsArr=[];this._inputOutputSettings&&(this._outputLayerSettingsArr=this._inputOutputSettings.getOutputSettings());for(c=0;c<this._outputLayerSettingsArr.length;c++)if(this._outputLayerSettingsArr[c].paramName===a){b===this.nls.summaryTab.outputOperatorCountOption&&
(d=!0);break}if(!d)for(c=0;c<this.inputParametersArray.length;c++)if(this.inputParametersArray[c].name===a){b===this.nls.summaryTab.inputOperatorCountOption&&(d=!0);break}return d},_validateFieldEntry:function(a,b){for(var c=!1,d=0;d<this._inputOutputParamArray.length;d++)if(a===this._inputOutputParamArray[d].name)for(var e=0;e<this._inputOutputParamArray[d].defaultValue.fields.length;e++)b===this._inputOutputParamArray[d].defaultValue.fields[e].name&&(c=!0);return c},_validateFieldOperatorEntry:function(a){var b=
!1;if(a===this.nls.summaryTab.fieldOperatorSumOption||a===this.nls.summaryTab.fieldOperatorMinOption||a===this.nls.summaryTab.fieldOperatorMaxOption||a===this.nls.summaryTab.fieldOperatorMeanOption)b=!0;return b},validateExpression:function(a){var b,c,d,e;c=[];b=this._editorObj.value;""!==b&&null!==b&&0===c.length&&b.replace(/\{(.+?)\}/g,function(a,b){d=b.replace(/\s/g,"");c.push(d)});e=!0;0<c.length&&(e=this._validateExpressionEntry(c));-1!==b.indexOf("{}")&&(e=!1);if(!0===e)if(a)this._errorMessage(this.nls.validationErrorMessage.validSummaryExpression);
else return{returnErr:"",returnFlag:!1};else if(a)this._errorMessage(this.nls.validationErrorMessage.invalidSummaryExpression);else return{returnErr:this.nls.validationErrorMessage.invalidSummaryExpression,returnFlag:!0}}})});