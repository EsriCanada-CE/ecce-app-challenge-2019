// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/Infographic/setting/dijitsSetting/ChartDijitSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"flex-lc text-label" style\x3d"font-size: 14px;"\x3e${nls.chartSettings}\x3c/div\x3e\r\n  \x3cdiv class\x3d"section data-section padding-right-5" data-dojo-attach-point\x3d"dataSection"\x3e\r\n    \x3cdiv class\x3d"section-item chart-mode-section-item feature-mode category-mode count-mode field-mode average-align"\x3e\r\n      \x3cdiv\x3e${nls.displayMode}\x3c/div\x3e\r\n      \x3cselect data-dojo-attach-point\x3d"chartModeSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:_onChartModeChanged" class\x3d"restrict-select-width"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section-item label-field-section-item category-field-section-item feature-mode category-mode count-mode average-align"\x3e\r\n      \x3cdiv\x3e${nls.categoryField}\x3c/div\x3e\r\n      \x3cselect data-dojo-attach-point\x3d"clusterFieldSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:_onClusterFieldChanged" class\x3d"restrict-select-width"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \r\n    \x3cdiv class\x3d"section-item category-mode count-mode"\x3e\r\n      \x3cdiv class\x3d"average-align" data-dojo-attach-point\x3d"periodDiv"\x3e\r\n        \x3cdiv\x3e${nls.minPeriod}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"periodSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:onChange" class\x3d"restrict-select-width"\x3e\r\n          \x3coption value\x3d"automatic"\x3e${nls.automatic}\x3c/option\x3e\r\n          \x3coption value\x3d"year"\x3e${nls.year}\x3c/option\x3e\r\n          \x3coption value\x3d"month"\x3e${nls.month}\x3c/option\x3e\r\n          \x3coption value\x3d"day"\x3e${nls.day}\x3c/option\x3e\r\n          \x3coption value\x3d"hour"\x3e${nls.hour}\x3c/option\x3e\r\n          \x3coption value\x3d"minute"\x3e${nls.minute}\x3c/option\x3e\r\n          \x3coption value\x3d"second"\x3e${nls.second}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \r\n    \x3cdiv class\x3d"section-item category-mode count-mode"\x3e\r\n      \x3cdiv style\x3d"height: auto; margin-top: 5px;margin-bottom: 5px;display: none;" class\x3d"average-align flexStart" data-dojo-attach-point\x3d"periodsRecordsDiv"\x3e\r\n        \x3cdiv\x3e${nls.periodsWithOutRecords}\x3c/div\x3e\r\n        \x3cdiv class\x3d"tb-radio-div"\x3e\r\n          \x3cdiv class\x3d"lr-radio-label-div"\x3e\r\n            \x3cinput checked type\x3d"radio" name\x3d"periodswithoutrecords" data-dojo-attach-event\x3d"change:onChange" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"showRadioBtn"\x3e\r\n            \x3clabel class\x3d"marginleft10 textOverFlow tb-radio-label" title\x3d"${nls.show}"\x3e${nls.show}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv style\x3d"margin-top: 10px;" class\x3d"lr-radio-label-div"\x3e\r\n            \x3cinput type\x3d"radio" name\x3d"periodswithoutrecords" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"hideRadioBtn"\x3e\r\n            \x3clabel class\x3d"marginleft10 textOverFlow tb-radio-label" title\x3d"${nls.hide}"\x3e${nls.hide}\x3c/label\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e \r\n\r\n    \x3cdiv class\x3d"section-item operation-section-item category-mode field-mode average-align"\x3e\r\n      \x3cdiv\x3e${nls.operation}\x3c/div\x3e\r\n      \x3cselect data-dojo-attach-point\x3d"operationSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:onChange" class\x3d"restrict-select-width"\x3e\r\n        \x3coption value\x3d"sum"\x3e${nls.sumOption}\x3c/option\x3e\r\n        \x3coption value\x3d"average"\x3e${nls.averageOption}\x3c/option\x3e\r\n        \x3coption value\x3d"min"\x3e${nls.minOption}\x3c/option\x3e\r\n        \x3coption value\x3d"max"\x3e${nls.maxOption}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"section-item category-mode field-mode"\x3e  \r\n      \x3cdiv style\x3d"height: auto; margin-top: 5px;margin-bottom: 10px;" class\x3d"average-align flexStart" data-dojo-attach-point\x3d"nullValue"\x3e  \r\n        \x3cdiv\x3e${nls.nullValue}\x3c/div\x3e  \r\n        \x3cdiv class\x3d"tb-radio-div"\x3e \r\n          \x3cdiv class\x3d"lr-radio-label-div"\x3e \r\n            \x3cinput checked type\x3d"radio" name\x3d"nullValue" data-dojo-attach-event\x3d"change:onChange" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"zeroRadioBtn"\x3e \r\n           \x3clabel class\x3d"marginleft10 textOverFlow tb-radio-label" title\x3d"${nls.calculatedAsZero}"\x3e${nls.calculatedAsZero}\x3c/label\x3e  \r\n          \x3c/div\x3e \r\n          \x3cdiv style\x3d"margin-top: 10px;" class\x3d"lr-radio-label-div"\x3e \r\n            \x3cinput type\x3d"radio" name\x3d"nullValue" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"ignoreRadioBtn"\x3e  \r\n            \x3clabel class\x3d"marginleft10 textOverFlow tb-radio-label" title\x3d"${nls.ignored}"\x3e${nls.ignored}\x3c/label\x3e  \r\n          \x3c/div\x3e \r\n        \x3c/div\x3e \r\n      \x3c/div\x3e \r\n    \x3c/div\x3e \r\n\r\n    \x3cdiv style\x3d"height: auto;" class\x3d"section-item value-fields-section-item feature-mode category-mode field-mode average-align"\x3e\r\n      \x3cdiv\x3e${nls.valueFields}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"valueFieldsDiv"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv style\x3d"height: auto; margin-top: 10px" class\x3d"section-item feature-mode category-mode count-mode field-mode average-align flexStart"\x3e\r\n      \x3cdiv\x3e${nls.sortBy}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"chartSort"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \r\n    \x3cdiv style\x3d"margin-top: 5px" class\x3d"section-item feature-mode category-mode count-mode field-mode average-align"\x3e\r\n      \x3cdiv\x3e${nls.maxCategories}\x3c/div\x3e\r\n       \x3cinput data-dojo-attach-point\x3d"maxLabels" data-dojo-type\x3d"dijit/form/NumberSpinner"  data-dojo-props\x3d"intermediateChanges:true" data-dojo-attach-event\x3d"change:onChange"\r\n      /\x3e\r\n    \x3c/div\x3e\r\n\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"section display-section padding-right-5" data-dojo-attach-point\x3d"displaySection"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"bgColorDiv" class\x3d"section-item column-type bar-type pie-type line-type average-align"\x3e\r\n      \x3cdiv\x3e${nls.backgroundColor}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \r\n    \x3cdiv style\x3d"margin-bottom: 10px;" class\x3d"section-item pie-type average-align"\x3e\r\n      \x3cdiv\x3e${nls.hollowsize}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"hollowSize"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"chartColorContainer" style\x3d"height: auto;margin: 10px auto 0 auto;" class\x3d"section-item column-type bar-type pie-type line-type average-align flexStart"\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"legendTogglePocketContent"\x3e\r\n      \x3cdiv class\x3d"average-align" data-dojo-attach-point\x3d"legendTextColorDiv"\x3e\r\n        \x3cdiv\x3e${nls.textColor}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"average-align"\x3e\r\n        \x3cdiv\x3e${nls.textSize}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"legendTextSize"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"horTogglePocketContent"\x3e\r\n      \x3cdiv class\x3d"average-align"\x3e\r\n        \x3cdiv\x3e${nls.title}\x3c/div\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"horTitle" data-dojo-attach-event\x3d"change:onChange" /\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"average-align" data-dojo-attach-point\x3d"horTitleColorDiv"\x3e\r\n        \x3cdiv\x3e${nls.titleColor}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"average-align" data-dojo-attach-point\x3d"horTextColorDiv"\x3e\r\n        \x3cdiv\x3e${nls.labelColor}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"average-align"\x3e\r\n        \x3cdiv\x3e${nls.labelSize}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"horTextSize"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"hAxisKeepIntScaleRow" class\x3d"average-align"\x3e\r\n        \x3cdiv class\x3d"left-label textOverFlow" title\x3d"${nls.intScaleText}"\x3e${nls.intScaleText}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"verTogglePocketContent"\x3e\r\n       \x3cdiv class\x3d"average-align"\x3e\r\n        \x3cdiv\x3e${nls.title}\x3c/div\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"verTitle" data-dojo-attach-event\x3d"change:onChange" /\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"average-align" data-dojo-attach-point\x3d"verTitleColorDiv"\x3e\r\n        \x3cdiv\x3e${nls.titleColor}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"average-align" data-dojo-attach-point\x3d"verTextColorDiv"\x3e\r\n        \x3cdiv\x3e${nls.labelColor}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"average-align"\x3e\r\n        \x3cdiv\x3e${nls.labelSize}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"verTextSize"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"vAxisKeepIntScaleRow" class\x3d"average-align"\x3e\r\n        \x3cdiv class\x3d"left-label textOverFlow" title\x3d"${nls.intScaleText}"\x3e${nls.intScaleText}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"dataLabelTogglePocketContent"\x3e\r\n      \x3cdiv class\x3d"average-align" data-dojo-attach-point\x3d"dataLabelTextColorDiv"\x3e\r\n        \x3cdiv\x3e${nls.textColor}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"average-align"\x3e\r\n        \x3cdiv\x3e${nls.textSize}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"dataLabelTextSize"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"section guide-section" data-dojo-attach-point\x3d"marksSection"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/on dojo/query dojo/_base/lang dojo/_base/html dojo/_base/declare dojo/Evented ./BaseDijitSetting dijit/_WidgetsInTemplateMixin dojo/text!./ChartDijitSetting.html jimu/dijit/TabContainer3 jimu/utils ./_dijits/ChartSort ./_dijits/TogglePocket ./_dijits/VisibleSliderBar ./_dijits/SeriesStyle/SeriesStyle ./_dijits/Mark/Marks ./_dijits/ChartColorSetting ./_dijits/DataFields ./_dijits/Toggle ../utils dijit/form/ValidationTextBox dijit/form/Select dijit/form/RadioButton dijit/form/NumberSpinner dijit/form/TextBox".split(" "),
function(e,v,f,k,x,y,z,A,B,C,D,E,q,p,F,G,l,H,w,g){return x([z,A,y],{templateString:B,type:"chart",baseClass:"infographic-chart-dijit-setting",colors:"#68D2E0 #087E92 #47BCF5 #FBE66A #F29157 #C8501D #2DB7C6 #C4EEF6".split(" "),config:null,_defColor:null,_modes:null,_clusterFields:null,_valueFields:null,postMixInProperties:function(){f.mixin(this.nls,window.jimuNls.statisticsChart)},constructor:function(a){this.inherited(arguments);a.nls&&(this.nls=a.nls);this.config=a.config;this._initChartKeyProperty(this.config);
this._defColor=g.getDefaultColorOfTheme(a.appConfig&&a.appConfig.theme)},setLayerDefinition:function(a){this.definition=a=g.preProcessDefinition(a);this.seriesStyleDijit&&this.seriesStyleDijit.setLayerDefinition(a)},setLayerObject:function(a){this.layerObject=a},setConfig:function(a){a&&(this.config=a,this._initChartKeyProperty(a))},setFeatures:function(a){this.seriesStyleDijit&&this.seriesStyleDijit.setFeatures(a)},_initDijitInTemplate:function(){this.valueFields=new H;this.valueFields.placeAt(this.valueFieldsDiv);
this.own(e(this.valueFields,"change",this._onValueFieldsChanged.bind(this)));this.bgColor=new l;this.bgColor.placeAt(this.bgColorDiv,"last");this.own(e(this.bgColor,"change",this.onChange.bind(this)));this.legendTextColor=new l;this.legendTextColor.placeAt(this.legendTextColorDiv,"last");this.own(e(this.legendTextColor,"change",this.onChange.bind(this)));this.horTitleColor=new l;this.horTitleColor.placeAt(this.horTitleColorDiv,"last");this.own(e(this.horTitleColor,"change",this.onChange.bind(this)));
this.horTextColor=new l;this.horTextColor.placeAt(this.horTextColorDiv,"last");this.own(e(this.horTextColor,"change",this.onChange.bind(this)));this.hAxisKeepIntScale=new w;this.hAxisKeepIntScale.placeAt(this.hAxisKeepIntScaleRow,"last");this.own(e(this.hAxisKeepIntScale,"change",this.onChange.bind(this)));this.verTitleColor=new l;this.verTitleColor.placeAt(this.verTitleColorDiv,"last");this.own(e(this.verTitleColor,"change",this.onChange.bind(this)));this.verTextColor=new l;this.verTextColor.placeAt(this.verTextColorDiv,
"last");this.own(e(this.verTextColor,"change",this.onChange.bind(this)));this.vAxisKeepIntScale=new w;this.vAxisKeepIntScale.placeAt(this.vAxisKeepIntScaleRow,"last");this.own(e(this.vAxisKeepIntScale,"change",this.onChange.bind(this)));this.dataLabelTextColor=new l;this.dataLabelTextColor.placeAt(this.dataLabelTextColorDiv,"last");this.own(e(this.dataLabelTextColor,"change",this.onChange.bind(this)))},_initChartKeyProperty:function(a){if(a){var b=a.data;a=a.display;b?(this.keyProperties={type:b.type},
a&&(this.keyProperties.stack=a.stack,this.keyProperties.area=a.area,this.keyProperties.innerRadius=a.innerRadius)):(this.keyProperties={},console.error("Invalid configuration file or template"))}},postCreate:function(){this.inherited(arguments);this._initDijitInTemplate();this._ignoreEvent();this._createInitNodeByType(this.config);this._careEvent()},setDataSource:function(a){this.inherited(arguments);if(this.definition&&this.config){this._setDataSourceToDijits(a);this.dataSource=a;this._initNodesByDataSource(a);
var b=this.config.data&&this.config.data.mode;b||(b=this._modes&&this._modes[0]);b?(this._onModeChanged(b,!0),this._ignoreEvent(),this._setConfig(this.config),this._careEvent()):console.error("Invalid mode")}else console.warn("No layer definition or config, set data source error.")},_setDataSourceToDijits:function(a){this.seriesStyleDijit&&this.seriesStyleDijit.setDataSource(a)},_onChartModeChanged:function(a){this.ignoreChangeEvents||(this._onModeChanged(a),this.onChange())},_onModeChanged:function(a,
b){this.reset();var c=b?this.config.data.clusterField:this.clusterFieldSelect.get("value");this._updateElementDisplayByChartMode(a);this._chartModeTriggerForModeSelect(a);this._chartModeTriggerForDateOption(c);this._chartModeTriggerForSort(a);this._chartModeTriggerForLegend(a);this._chartModeTriggerForValueFields(a);this._chartModeTriggerForSeriesStyle(a,b);this._emitSettingChange(a,c)},_emitSettingChange:function(a,b){b=b||this.clusterFieldSelect.get("value");a=a||this.chartModeSelect.get("value");
b=this._isClusterDateType(b);this.emit("chartSettingChanged",{mode:a,isDataType:b})},_chartModeTriggerForModeSelect:function(a){g.updateOptions(this.chartModeSelect,null,a);this._updateSelectTitleByValue(this.chartModeSelect,a)},_chartModeTriggerForSort:function(a){this.chartSortDijit.setMode(a);a=this._getSortFields(a,!0);this.chartSortDijit.setFields(a)},_chartModeTriggerForLegend:function(a){var b=this.config.display&&this.config.display.seriesStyle;this._updateLegendDisplay(a,b&&b.type)},_chartModeTriggerForValueFields:function(a){this._shouldValueFieldAsSingleMode(a)?
this.valueFields.setSingleMode():this.valueFields.setMultipleMode()},_chartModeTriggerForSeriesStyle:function(a,b){var c=this.config&&this.config.data,d=b?c&&c.clusterField:this.clusterFieldSelect.get("value");b=b?c&&c.valueFields:this.valueFields.getSelectedFieldNames();this.seriesStyleDijit.render(a,d,b)},_chartModeTriggerForDateOption:function(a){a=a||this.clusterFieldSelect.get("value");this._updateDateOptionContainerDisplay(a)},reset:function(){g.updateOptions(this.clusterFieldSelect,null,this._clusterFields&&
this._clusterFields[0]&&this._clusterFields[0].name);this._updateDateOptionContainerDisplay();this.valueFields.uncheckAllFields();this.chartSortDijit.reset();this.maxLabels.set("value","");"pie"===this.keyProperties.type&&this.maxLabels.set("value",100);this.clearMarks()},_setConfig:function(a){if(a){var b=a.data;a=a.display;var c,d,e,f,g,k,l;b&&(c=b.clusterField,d=b.valueFields,e=b.operation,f=b.dateConfig,g=b.sortOrder,k=b.maxLabels,l=b.nullValue);this.clusterFieldSelect.set("value",c);this.valueFields.selectFields(d);
this.operationSelect.set("value",e);f&&(this.periodSelect.set("value",f.minPeriod),this.showRadioBtn.setChecked(f.isNeedFilled),this.hideRadioBtn.setChecked(!f.isNeedFilled));g&&this.chartSortDijit.setConfig(g);"undefined"!==typeof k?this.maxLabels.set("value",k):this.maxLabels.set("value","");"undefined"!==typeof l&&(this.zeroRadioBtn.setChecked(l),this.ignoreRadioBtn.setChecked(!l));var p,q,t,m,n,h,r,u;a&&(p=a.backgroundColor,q=a.seriesStyle,t=a.innerRadius,m=a.legend,n=a.xAxis,h=a.yAxis,r=a.dataLabel,
u=a.marks);q&&this.seriesStyleDijit.setConfig(q);"undefined"!==typeof t&&this.hollowSizeControl.setValue(t);p&&this.bgColor.setSingleColor(p);d=m&&m.show;b=(c=m&&m.textStyle)&&c.color;c=c&&c.fontSize;this.legendTogglePocket.setState(!!d);b&&this.legendTextColor.setSingleColor(b);c&&this.legendTextSizeControl.setValue(c);d=h&&h.show;this.verTogglePocket.setState(!("undefined"!==typeof d&&!d));m=h&&h.name;c=h&&h.textStyle;b=h&&h.nameTextStyle;d=h&&h.format;h=b&&b.color;b=c&&c.color;c=c&&c.fontSize;
d=d&&d.type;m&&this.verTitle.set("value",m);h&&this.verTitleColor.setSingleColor(h);b&&this.verTextColor.setSingleColor(b);c&&this.verticalAxisTextSizeControl.setValue(c);"int"===d&&this.vAxisKeepIntScale.setState(!0);d=n&&n.show;this.horTogglePocket.setState(!("undefined"!==typeof d&&!d));m=n&&n.name;c=n&&n.textStyle;b=n&&n.nameTextStyle;d=n&&n.format;h=b&&b.color;b=c&&c.color;c=c&&c.fontSize;d=d&&d.type;m&&this.horTitle.set("value",m);h&&this.horTitleColor.setSingleColor(h);b&&this.horTextColor.setSingleColor(b);
c&&this.horizontalAxisTextSizeControl.setValue(c);"int"===d&&this.hAxisKeepIntScale.setState(!0);d=r&&r.show;b=(c=r&&r.textStyle)&&c.color;c=c&&c.fontSize;this.dataLabelTogglePocket.setState(!!d);b&&this.dataLabelTextColor.setSingleColor(b);c&&this.dataLabelSizeControl.setValue(c);u&&this.marks.setConfig(u)}},clearMarks:function(){this.marks&&this.marks.setConfig({})},isValid:function(){return this.definition?this.maxLabels.isValid()&&this.hollowSizeControl.isValid()&&this.legendTextSizeControl.isValid()&&
this.verticalAxisTextSizeControl.isValid()&&this.horizontalAxisTextSizeControl.isValid()&&this.dataLabelSizeControl.isValid():!1},getConfig:function(a){if(!this.isValid(a))return!1;var b=this.keyProperties.type;a={type:b,stack:this.keyProperties.stack,area:this.keyProperties.area,innerRadius:this.keyProperties.innerRadius};var c=this.chartModeSelect.get("value");a.mode=c;var d;if("feature"===c||"category"===c||"count"===c)d=this.clusterFieldSelect.get("value"),a.clusterField=d;this._isClusterDateType(d)&&
(d={},d.minPeriod=this.periodSelect.get("value"),d.isNeedFilled=this.showRadioBtn.checked,a.dateConfig=d);a.nullValue=this.zeroRadioBtn.checked;a.operation=this.operationSelect.get("value");a.valueFields=this.valueFields.getSelectedFieldNames();a.sortOrder=this.chartSortDijit.getConfig();a.maxLabels=this.maxLabels.get("value")||void 0;a.backgroundColor=this.bgColor.getSingleColor();d={textStyle:{}};d.show=this.legendTogglePocket.getState();d.textStyle.color=this.legendTextColor.getSingleColor();d.textStyle.fontSize=
this.legendTextSizeControl.getValue();a.legend=d;d={textStyle:{}};d.show=this.horTogglePocket.getState();if(c=this.horTitle.get("value"))d.name=c,d.nameTextStyle={},d.nameTextStyle.color=this.horTitleColor.getSingleColor();d.textStyle.color=this.horTextColor.getSingleColor();d.textStyle.fontSize=this.horizontalAxisTextSizeControl.getValue();c=null;"bar"===b&&(c={type:this.hAxisKeepIntScale.getState()?"int":"float"});d.format=c;a.xAxis=d;d={textStyle:{}};d.show=this.verTogglePocket.getState();if(c=
this.verTitle.get("value"))d.name=c,d.nameTextStyle={},d.nameTextStyle.color=this.verTitleColor.getSingleColor();d.textStyle.color=this.verTextColor.getSingleColor();d.textStyle.fontSize=this.verticalAxisTextSizeControl.getValue();c=null;if("column"===b||"line"===b)c={type:this.vAxisKeepIntScale.getState()?"int":"float"};d.format=c;a.yAxis=d;b={textStyle:{}};b.show=this.dataLabelTogglePocket.getState();b.textStyle.color=this.dataLabelTextColor.getSingleColor();b.textStyle.fontSize=this.dataLabelSizeControl.getValue();
a.dataLabel=b;a.innerRadius=this.hollowSizeControl.getValue();if(this.marks){b=this.marks.getConfig();if(!1===b)return!1;a.marks=b}this.seriesStyleDijit&&(b=this.seriesStyleDijit.getConfig(),a.seriesStyle=b);if(a=g.getChartConfig(a))return this.config=a;this.dijit.clearChart()},onChange:function(){this.ignoreChangeEvents||(this.getConfig(),this.updateDijit())},updateDijit:function(){D.isEqual(this.cacheConfig,this.config)||(this.dijit.setConfig(this.config),this.dijit.startRendering());this.cacheConfig=
null;this.cacheConfig=f.clone(this.config)},_createInitNodeByType:function(a){if(a=a.data){a=a.type;var b=[{title:this.nls.data,content:this.dataSection},{title:this.nls.display,content:this.displaySection}];"pie"!==a&&b.push({title:this.nls.marks,content:this.marksSection});"bar"===a?this._hideAxisKeepIntScale(!0):this._hideAxisKeepIntScale(!1);this.tabContainer=new C({average:!0,tabs:b});"pie"!==a?(this.marks=new G({chartType:a,nls:this.nls,folderUrl:this.folderUrl,defaultColor:this._defColor.textColor}),
this.marks.placeAt(this.marksSection),this.own(e(this.marks,"change",f.hitch(this,this.onChange))),this.valueFields.setMultipleMode()):this.valueFields.setSingleMode();this.bgColor.setSingleColor(this._defColor.bgColor);this.seriesStyleDijit=new F({nls:this.nls,map:this.map,chartInfo:{type:this.keyProperties.type,area:this.keyProperties.area}});this.seriesStyleDijit.placeAt(this.chartColorContainer);this.seriesStyleDijit.startup();this.own(e(this.seriesStyleDijit,"change",f.hitch(this,this.onChange)));
this.hollowSizeControl=new p({min:0,max:60,step:1,value:this.keyProperties.innerRadius||0});this.own(e(this.hollowSizeControl,"change",f.hitch(this,this.onChange)));this.hollowSizeControl.placeAt(this.hollowSize);this.legendTogglePocket=new q({titleLabel:this.nls.legend,content:this.legendTogglePocketContent,className:"section-item column-type bar-type line-type pie-type"});this.legendTogglePocket.setState(!1);this.own(e(this.legendTogglePocket,"change",f.hitch(this,this.onChange)));this.legendTogglePocket.placeAt(this.displaySection);
this.legendTextColor.setSingleColor(this._defColor.textColor);this.legendTextSizeControl=new p({min:6,max:40,step:1,value:12});this.own(e(this.legendTextSizeControl,"change",f.hitch(this,this.onChange)));this.legendTextSizeControl.placeAt(this.legendTextSize);this.verTogglePocket=new q({titleLabel:this.nls.verticalAxis,content:this.verTogglePocketContent,className:"section-item column-type bar-type line-type"});this.verTogglePocket.setState(!1);this.own(e(this.verTogglePocket,"change",f.hitch(this,
this.onChange)));this.verTogglePocket.placeAt(this.displaySection);this.verTextColor.setSingleColor(this._defColor.textColor);this.verTitleColor.setSingleColor(this._defColor.textColor);this.verticalAxisTextSizeControl=new p({min:6,max:40,step:1,value:12});this.own(e(this.verticalAxisTextSizeControl,"change",f.hitch(this,this.onChange)));this.verticalAxisTextSizeControl.placeAt(this.verTextSize);this.vAxisKeepIntScale.setState(!1);this.horTogglePocket=new q({titleLabel:this.nls.horizontalAxis,content:this.horTogglePocketContent,
className:"section-item column-type bar-type line-type"});this.horTogglePocket.setState(!1);this.own(e(this.horTogglePocket,"change",f.hitch(this,this.onChange)));this.horTogglePocket.placeAt(this.displaySection);this.horTextColor.setSingleColor(this._defColor.textColor);this.horTitleColor.setSingleColor(this._defColor.textColor);this.horizontalAxisTextSizeControl=new p({min:6,max:40,step:1,value:12});this.own(e(this.horizontalAxisTextSizeControl,"change",f.hitch(this,this.onChange)));this.horizontalAxisTextSizeControl.placeAt(this.horTextSize);
this.hAxisKeepIntScale.setState(!1);this.dataLabelTogglePocket=new q({titleLabel:this.nls.dataLabels,content:this.dataLabelTogglePocketContent,className:"section-item pie-type"});this.dataLabelTogglePocket.setState(!1);this.own(e(this.dataLabelTogglePocket,"change",f.hitch(this,this.onChange)));this.dataLabelTogglePocket.placeAt(this.displaySection);this.dataLabelTextColor.setSingleColor(this._defColor.textColor);this.dataLabelSizeControl=new p({min:6,max:40,step:1,value:12});this.own(e(this.dataLabelSizeControl,
"change",f.hitch(this,this.onChange)));this.dataLabelSizeControl.placeAt(this.dataLabelTextSize);this.chartSortDijit=new E({nls:this.nls});this.own(e(this.chartSortDijit,"change",f.hitch(this,this.onChange)));this.chartSortDijit.placeAt(this.chartSort);this.tabContainer.placeAt(this.domNode);"pie"===a?(this.maxLabels.constraints={min:1,max:100},this.maxLabels.set("value",100),this.maxLabels.required=!0):(this.maxLabels.constraints={min:1,max:3E3},this.maxLabels.required=!1);this._updateElementDisplayByChartType(a)}},
_ignoreEvent:function(){this.ignoreChangeEvents=!0},_careEvent:function(){setTimeout(function(){this.ignoreChangeEvents=!1}.bind(this),200)},_updateSelectTitleByValue:function(a,b){(b=a.getOptions(b))&&"undefined"!==typeof b.label&&a.set("title",b.label)},_updateLegendDisplay:function(a,b){a=a||this.chartModeSelect.get("value");a=this._shouldLegendDisplay(a,b);b=this.keyProperties.type;a?this._showLegend(b):this._hideLegend()},_getValueFields:function(){return this.valueFields.getSelectedFieldNames()},
_getSortFields:function(a,b){var c=this.definition;if(c&&a&&(b=b?this.config.data&&this.config.data.valueFields:this._getValueFields(),"feature"===a||b&&b[0])){var d=[];"feature"===a?(d=f.clone(c.fields),d=g.getNotGeometryFields(d)):b&&(d=g.getFieldInfosByFieldName(b,c));return d.map(function(a){return{value:a.name,label:a.alias||a.name}})}},_initNodesByDataSource:function(a){this._initInfoByDataSource(a);this._fillModeSelect(this._modes);this._fillClusterFieldSelect(this._clusterFields);this._fillValueFieldLists(this._valueFields)},
_initInfoByDataSource:function(a){a&&(this._modes=this._getSupportedModes(a,this.definition),a=this._getSupportFields(this.definition),this._clusterFields=a[0],this._valueFields=a[1])},_getSupportedModes:function(a,b){if(b&&a){var c=!1,d=["feature","category","count","field"];if(a=a.frameWorkDsId)a=(this.appConfig.dataSource&&this.appConfig.dataSource.dataSources)[a],"FeatureStatistics"===a.type&&(c=!0,d=0<(f.clone(a.dataSchema).groupByFields||[]).length?g.hasNumberFields(b)?["category","count"]:
["count"]:["field"]);c||g.hasNumberFields(b)||(d=["count"]);return d}},_fillModeSelect:function(a){a&&(this.chartModeSelect.removeOption(this.chartModeSelect.getOptions()),a.forEach(function(a){"feature"===a?this.chartModeSelect.addOption({value:"feature",label:this.nls.featureOption}):"category"===a?this.chartModeSelect.addOption({value:"category",label:this.nls.categoryOption}):"count"===a?this.chartModeSelect.addOption({value:"count",label:this.nls.countOption}):"field"===a&&this.chartModeSelect.addOption({value:"field",
label:this.nls.fieldOption})}.bind(this)))},_getSupportFields:function(a){if(a){var b=f.clone(a.fields);if(b&&b.length){b.forEach(function(a){a.checked&&(a.checked=!1)});var c=a.groupByFields;a=g.getClusterFields(b,c);b=g.getValueFields(b,c,a);return[a,b]}}},_fillClusterFieldSelect:function(a){a=a.map(function(a){return{label:a.alias||a.name,value:a.name}});g.updateOptions(this.clusterFieldSelect,a)},_fillValueFieldLists:function(a){this.valueFields.setFields(a)},_onClusterFieldChanged:function(a){if(!this.ignoreChangeEvents){this._updateDateOptionContainerDisplay(a);
var b=this.chartModeSelect.get("value"),c=this.valueFields.getSelectedFieldNames();this.seriesStyleDijit.render(b,a,c);this.onChange();this._emitSettingChange(b,a)}},_onValueFieldsChanged:function(){if(!this.ignoreChangeEvents){var a=this.chartModeSelect.get("value"),b=this.clusterFieldSelect.get("value"),c=this.valueFields.getSelectedFieldNames();this.seriesStyleDijit.render(a,b,c);a=this._getSortFields(a);this.chartSortDijit.setFields(a);this.onChange()}},_shouldShowDateOption:function(a){var b=
this.chartModeSelect.get("value");a=a||this.clusterFieldSelect.get("value");a=g.isDateField(a,this.definition);return("category"===b||"count"===b)&&a},_showDateOptionContainer:function(a){"pie"!==a&&this._showPeriodsRecordsDiv();this._showPeridoDiv()},_hideDateOptionContainer:function(){this._hidePeridoDiv();this._hidePeriodsRecordsDiv()},_showPeridoDiv:function(){k.setStyle(this.periodDiv,"display","")},_hidePeridoDiv:function(){k.setStyle(this.periodDiv,"display","none")},_showPeriodsRecordsDiv:function(){k.setStyle(this.periodsRecordsDiv,
"display","")},_hidePeriodsRecordsDiv:function(){k.setStyle(this.periodsRecordsDiv,"display","none")},_hideLegend:function(){this.legendTogglePocket&&this.legendTogglePocket.hide()},_showLegend:function(){this.legendTogglePocket&&this.legendTogglePocket.show()},_hideAxisKeepIntScale:function(a){a?(k.addClass(this.vAxisKeepIntScaleRow,"hide"),k.removeClass(this.hAxisKeepIntScaleRow,"hide")):(k.addClass(this.hAxisKeepIntScaleRow,"hide"),k.removeClass(this.vAxisKeepIntScaleRow,"hide"))},_showSectionItem:function(a){k.removeClass(a,
"hide")},_hideSectionItem:function(a){k.addClass(a,"hide")},_shouldValueFieldAsSingleMode:function(a){var b=this.keyProperties.type;return("feature"===a||"category"===a)&&"pie"===b},_shouldLegendDisplay:function(a,b){var c;"pie"===this.keyProperties.type?c=!0:(c=!0,c="count"===a||"field"===a?!1:"layerSymbol"!==b);return c},_tryGetLayerIdFromDataSource:function(a){if(a){var b=a.layerId;a=a.frameWorkDsId;!b&&a&&(a=g.parseDataSourceId(a))&&"undefined"!==a.layerId&&(b=a.layerId);return b}},_updateDateOptionContainerDisplay:function(a){a=
this._shouldShowDateOption(a);var b=this.keyProperties.type;a?this._showDateOptionContainer(b):this._hideDateOptionContainer()},_isClusterDateType:function(a){return this._shouldShowDateOption(a)},_updateElementDisplayByChartMode:function(a){var b=a+"-mode";v(".section-item",this.dataSection).forEach(f.hitch(this,function(a){k.hasClass(a,b)?this._showSectionItem(a):this._hideSectionItem(a)}))},_updateElementDisplayByChartType:function(a){var b=a+"-type";v(".section-item",this.displaySection).forEach(f.hitch(this,
function(a){k.hasClass(a,b)?this._showSectionItem(a):this._hideSectionItem(a)}))},_showChartNoData:function(a){setTimeout(function(){a&&this.dijit.setConfig(a);this.dijit.clearChart()}.bind(this),200)},_getDefaultFieldName:function(){var a;this._clusterFieldOptions&&this._clusterFieldOptions[0]&&(a=this._clusterFieldOptions[0].value);return a}})});